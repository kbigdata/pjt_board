# KanFlow - 추가 기능 요구서 (Notion/Slack 벤치마크 기반)

> **문서명**: 추가 기능 요구서 - Notion/Slack 핵심 기능 벤치마크 기반 누락 기능 분석  
> **버전**: v1.0  
> **작성일**: 2026-02-24  
> **기준 문서**: KanFlow-FRD-ClaudeCode-Setup-v2.0-20260224.md  
> **분석 대상**: Notion (Database/Page/Share), Slack (Thread/Webhook/Presence/Pin)  
> **목적**: 기존 FRD에서 누락된 실무 필수 기능 식별 및 상세 명세  

---

## 목차

1. [분석 개요](#1-분석-개요)
2. [카드 템플릿 시스템](#2-카드-템플릿-시스템)
3. [서브태스크 / 부모-자식 카드 계층](#3-서브태스크--부모-자식-카드-계층)
4. [스레드형 코멘트](#4-스레드형-코멘트)
5. [고정(Pin) 시스템](#5-고정pin-시스템)
6. [리치 블록 에디터](#6-리치-블록-에디터)
7. [Webhook / 외부 시스템 연동](#7-webhook--외부-시스템-연동)
8. [사용자 상태 및 프레즌스](#8-사용자-상태-및-프레즌스)
9. [공유 링크 / 게스트 접근](#9-공유-링크--게스트-접근)
10. [기존 FRD 통합 영향 분석](#10-기존-frd-통합-영향-분석)
11. [구현 로드맵 제안](#11-구현-로드맵-제안)

---

## 1. 분석 개요

### 1.1 분석 배경

기존 KanFlow FRD v2.0은 Trello, Jira Kanban, Azure DevOps Boards, KanbanTool, Businessmap을 기반으로 ~145개 기능을 정의하였다. 그러나 현대 협업 도구의 양대 산맥인 **Notion**과 **Slack**의 핵심 기능 중 칸반 보드 제품에 실질적으로 필요한 기능이 누락되어 있다.

본 문서는 Notion과 Slack의 기능을 칸반 보드 관점에서 대조 분석하여, 실무 활용에서 없으면 **즉시 불편을 느끼거나 경쟁력이 떨어지는** 기능만을 선별하여 상세 명세한다.

### 1.2 분석 방법론

```
┌─────────────────────────────────────────────────────────────┐
│                     분석 워크플로우                            │
│                                                              │
│  ┌──────────────┐    ┌──────────────┐    ┌──────────────┐   │
│  │ Notion/Slack │    │ 기존 FRD     │    │  GAP 분석    │   │
│  │ 기능 목록    │───▶│ 대조 매핑    │───▶│ 누락 식별    │   │
│  │ 추출        │    │              │    │              │   │
│  └──────────────┘    └──────────────┘    └──────┬───────┘   │
│                                                  │           │
│                      ┌──────────────┐    ┌──────▼───────┐   │
│                      │ 상세 명세    │◀───│ 칸반 적합성  │   │
│                      │ + 객체 모델  │    │ 필터링       │   │
│                      └──────────────┘    └──────────────┘   │
│                                                              │
│  필터링 기준:                                                 │
│  ✅ 칸반 보드 제품에 직접 적용 가능                            │
│  ✅ 실무에서 부재 시 즉시 불편                                 │
│  ❌ Notion/Slack 고유 기능 (문서 위키, 채널 등)               │
│  ❌ 기존 FRD에 이미 포함된 기능                               │
└─────────────────────────────────────────────────────────────┘
```

### 1.3 누락 기능 전체 맵

```
추가 기능 전체 맵 (8개 카테고리, 29개 기능)
│
├── 📋 카드 템플릿 시스템 (Notion Database Template 기반)
│   ├── CT-001 카드 템플릿 생성
│   ├── CT-002 템플릿 선택 생성
│   └── CT-003 기존 카드 → 템플릿 저장
│
├── 🧩 서브태스크 / 부모-자식 계층 (Notion Sub-page + Jira Epic-Story 기반)
│   ├── ST-001 서브태스크 생성
│   ├── ST-002 서브태스크 진행률
│   ├── ST-003 서브태스크 보드 표시
│   └── ST-004 부모 자동 완료
│
├── 💬 스레드형 코멘트 (Slack Thread 기반)
│   ├── TH-001 코멘트 답글(Thread)
│   ├── TH-002 스레드 접기/펼치기
│   └── TH-003 스레드 알림
│
├── 📌 고정(Pin) 시스템 (Slack Pinned Items 기반)
│   ├── PN-001 코멘트 고정
│   ├── PN-002 보드 공지 고정
│   └── PN-003 카드 개인 북마크
│
├── 📝 리치 블록 에디터 (Notion Block Editor 기반)
│   ├── RE-001 토글 블록
│   ├── RE-002 콜아웃 블록
│   ├── RE-003 코드 블록 구문 강조
│   ├── RE-004 테이블 블록
│   └── RE-005 슬래시 명령 에디터
│
├── 🔗 Webhook / 외부 연동 (Slack Webhook 기반)
│   ├── WH-001 Outgoing Webhook
│   ├── WH-002 Incoming Webhook
│   ├── WH-003 Webhook 관리
│   └── WH-004 Webhook 시크릿
│
├── 🟢 사용자 상태 / 프레즌스 (Slack Status & Presence 기반)
│   ├── UP-001 사용자 커스텀 상태
│   ├── UP-002 상태 표시 위치
│   └── UP-003 방해 금지 모드
│
└── 🔓 공유 링크 / 게스트 접근 (Notion Share to Web 기반)
    ├── SL-001 보드 공유 링크
    ├── SL-002 카드 공유 링크
    ├── SL-003 게스트 초대
    └── SL-004 공유 링크 비활성화
```

### 1.4 우선순위 분류 (기존 FRD 기준 동일)

| 등급 | 추가 기능 수 | 대상 |
|------|-------------|------|
| **P1 (Should Have)** | 22개 | 카드 템플릿, 서브태스크, 스레드 코멘트, 고정, 코드 블록, Webhook, 공유 링크 |
| **P2 (Nice to Have)** | 7개 | 리치 에디터 고급 블록, 사용자 상태, 카드 공유 링크 |
| **합계** | **29개** | |

---

## 2. 카드 템플릿 시스템

### 2.1 누락 근거

> **Notion 벤치마크**: Notion의 Database Template은 새 항목 생성 시 미리 정의된 구조(속성, 본문 블록)를 자동 적용한다. Notion 사용자의 핵심 워크플로우 중 하나.

**기존 FRD 상태**: 보드 템플릿(TM-001~003)은 보드 구조(컬럼, 스윔레인, 라벨)를 복제하지만, **카드 레벨 템플릿이 부재**하다. 반복적으로 동일 구조의 카드(버그 리포트, 기능 요청, 회의록 등)를 생성할 때 매번 체크리스트, 라벨, 설명 양식을 수동 설정해야 하는 비효율이 발생한다.

### 2.2 기능 상세

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| CT-001 | 카드 템플릿 생성 | 보드별 카드 템플릿 정의. 포함 가능 속성: 제목 패턴, 설명(마크다운 본문), 체크리스트(항목 포함), 라벨 프리셋, 기본 담당자, 기본 우선순위, 태그 | P1 |
| CT-002 | 템플릿 선택 생성 | 카드 생성 시 "빈 카드" 또는 등록된 템플릿 목록에서 선택. 컬럼 하단 "+" 버튼 클릭 시 드롭다운 표시 | P1 |
| CT-003 | 기존 카드를 템플릿으로 | 카드 상세 모달의 액션 메뉴에서 "템플릿으로 저장" → 현재 카드의 구조를 템플릿으로 등록 (카드 고유 데이터 제외, 구조만 추출) | P1 |

### 2.3 객체 모델

```
CardTemplate {
  id: cuid
  name: string (1~100자, 예: "버그 리포트", "기능 요청")
  description: string? (마크다운, 최대 5000자, 카드 설명 기본값)
  boardId: FK → Board
  
  // 프리셋 속성
  defaultLabels: Label[] (기본 적용 라벨)
  defaultAssignees: User[] (기본 담당자)
  defaultPriority: "critical" | "high" | "medium" | "low" | null
  defaultTags: string[] (기본 태그)
  
  // 체크리스트 템플릿
  checklistTemplates: [{
    title: string
    items: [{ text: string, checked: false }]
  }]
  
  // 메타
  createdBy: FK → User
  usageCount: int (사용 횟수 통계)
  createdAt, updatedAt
}
```

### 2.4 UI 워크플로우

```
카드 템플릿 생성 워크플로우:

  [보드 설정] → [카드 템플릿] → [+ 새 템플릿]
       │
       ▼
  ┌────────────────────────────────┐
  │ 템플릿 이름: [버그 리포트     ]│
  │                                │
  │ 설명 (본문 기본값):             │
  │ ┌──────────────────────────┐   │
  │ │ ## 버그 설명              │   │
  │ │ - 환경:                  │   │
  │ │ - 재현 절차:             │   │
  │ │ ## 기대 동작              │   │
  │ │ ## 실제 동작              │   │
  │ └──────────────────────────┘   │
  │                                │
  │ 기본 라벨: [🟣 버그]          │
  │ 기본 우선순위: [High ▾]       │
  │ 기본 태그: [#bug]             │
  │                                │
  │ 체크리스트:                    │
  │ ☑ QA 체크리스트               │
  │   ☐ 재현 확인                 │
  │   ☐ 로그 첨부                 │
  │   ☐ 스크린샷 첨부             │
  │ [+ 체크리스트 추가]            │
  │                                │
  │        [취소] [저장]           │
  └────────────────────────────────┘


카드 생성 시 템플릿 선택:

  컬럼 하단 [+] 클릭
       │
       ▼
  ┌──────────────────┐
  │ 📄 빈 카드        │ ← 기존 동작 (기본 선택)
  │ ─────────────────│
  │ 📋 버그 리포트    │ ← 템플릿 1
  │ 📋 기능 요청     │ ← 템플릿 2
  │ 📋 회의록        │ ← 템플릿 3
  └──────────────────┘
       │
       ▼ (템플릿 선택 시)
  카드 생성 + 템플릿 속성 자동 적용
  → 제목 입력 포커스
```

### 2.5 API 엔드포인트

```
POST   /api/boards/:boardId/card-templates          # 템플릿 생성
GET    /api/boards/:boardId/card-templates          # 템플릿 목록 조회
GET    /api/boards/:boardId/card-templates/:id      # 템플릿 상세 조회
PATCH  /api/boards/:boardId/card-templates/:id      # 템플릿 수정
DELETE /api/boards/:boardId/card-templates/:id      # 템플릿 삭제
POST   /api/boards/:boardId/card-templates/:id/use  # 템플릿으로 카드 생성
POST   /api/cards/:cardId/save-as-template          # 기존 카드 → 템플릿 저장
```

---

## 3. 서브태스크 / 부모-자식 카드 계층

### 3.1 누락 근거

> **Notion 벤치마크**: Notion의 페이지 안에 하위 페이지를 생성하여 계층 구조를 만드는 패턴.  
> **Jira 벤치마크**: Jira의 Epic → Story → Sub-task 3단계 계층 구조.

**기존 FRD 상태**: 체크리스트(CK-001~009)는 단순 완료/미완료 토글이며, 카드 연결(LK-001~004)은 관계(blocks/relates to)를 정의하지만 **계층(부모-자식) 구조가 아니다**. 체크리스트 항목은 독립적인 담당자, 컬럼 이동, 활동 로그를 가질 수 없다.

CK-006("항목을 카드로 변환")은 일회성 변환으로 부모-자식 관계가 유지되지 않는다. 복잡한 작업을 분해하여 각 하위 작업이 독립 카드로서 워크플로우를 따르면서도 부모 카드에서 전체 진행률을 파악하는 것은 실무에서 필수적이다.

### 3.2 기능 상세

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| ST-001 | 서브태스크 생성 | 카드 상세 모달에서 "서브태스크 추가" → 하위 카드 생성. 부모 카드 ID를 `parentCardId`로 참조 유지. 서브태스크는 독립 카드와 동일한 모든 속성(담당자, 라벨, 마감일, 컬럼 위치 등)을 가짐 | P1 |
| ST-002 | 서브태스크 진행률 | 부모 카드에 하위 카드의 완료 비율 자동 계산 표시. 프로그레스 바 + "2/5 완료" 텍스트. "Done" 타입 컬럼에 있는 서브태스크를 완료로 카운트 | P1 |
| ST-003 | 서브태스크 보드 표시 | 서브태스크는 보드에서 독립 카드로 표시되며, 부모 카드 번호가 배지로 표시됨 (예: "↑ KF-042"). 옵션: 서브태스크 보드 표시/숨기기 토글 | P1 |
| ST-004 | 부모 자동 완료 | 모든 서브태스크가 "Done" 컬럼으로 이동 시 부모 카드를 자동으로 "Done"으로 이동 (자동화 규칙 엔진과 연계, 옵션 설정) | P2 |

### 3.3 객체 모델 변경

```
Card (기존 모델에 필드 추가) {
  ...기존 필드 유지...
  
  // 추가 필드
  parentCardId: FK → Card? (null = 최상위 카드)
  subtaskOrder: float (부모 카드 내 서브태스크 정렬 순서)
}

// 관계
Card 1 ──< N Card (parentCardId)
  - 1단계 계층만 허용 (서브태스크의 서브태스크는 불가, 복잡성 방지)
  - 부모 카드와 서브태스크는 반드시 같은 보드 내 존재
```

### 3.4 UI 워크플로우

```
카드 상세 모달 - 서브태스크 섹션:

┌─── 좌측 (70%) ──────────────────────────────────┐
│                                                   │
│ ── 서브태스크 (2/5 완료) ──  ████░░░░░░ 40%      │
│                                                   │
│ ┌─────────────────────────────────────────────┐   │
│ │ ✅ KF-043 │ API 엔드포인트 구현  │ 👤김 │Done│   │
│ │ ✅ KF-044 │ DTO 정의            │ 👤이 │Done│   │
│ │ ☐ KF-045 │ 프론트 컴포넌트      │ 👤박 │Prog│   │
│ │ ☐ KF-046 │ 테스트 작성          │ 미할당│Todo│   │
│ │ ☐ KF-047 │ 코드 리뷰            │ 미할당│Todo│   │
│ └─────────────────────────────────────────────┘   │
│ [+ 서브태스크 추가]                                │
│                                                   │
│ (서브태스크 클릭 시 해당 카드 상세 모달로 이동,     │
│  상단에 "← KF-042 부모 카드로 돌아가기" 링크 표시) │
└───────────────────────────────────────────────────┘


보드 뷰에서 서브태스크 표시:

┌─── In Progress ──────────────┐
│ ┌──────────────────────────┐ │
│ │ KF-042 사용자 인증 구현   │ │  ← 부모 카드
│ │ 🟣 🟠  👤김 👤이         │ │
│ │ ▓▓▓▓░░░░░ 2/5           │ │  ← 서브태스크 진행률
│ └──────────────────────────┘ │
│ ┌──────────────────────────┐ │
│ │ ↑KF-042                  │ │  ← 부모 배지
│ │ KF-045 프론트 컴포넌트    │ │  ← 서브태스크 (독립 카드)
│ │ 🟣  👤박                 │ │
│ └──────────────────────────┘ │
└──────────────────────────────┘
```

### 3.5 체크리스트와의 차이 및 공존

```
체크리스트 (CK-*):                서브태스크 (ST-*):
───────────────────              ───────────────────
• 단순 완료/미완료 토글           • 독립 카드 (모든 카드 속성 보유)
• 담당자/마감일 (P2 기능)         • 담당자/마감일/라벨/컬럼 이동
• 카드 내부에만 존재              • 보드에 독립 카드로 표시 가능
• 가벼운 할 일 목록               • 워크플로우를 따르는 하위 작업
• 예: "테스트 항목 체크"          • 예: "API 인증 모듈 구현"

공존 원칙:
  카드 안에 체크리스트도 있고 서브태스크도 있을 수 있음.
  체크리스트 = 가벼운 to-do, 서브태스크 = 독립 추적 필요한 하위 작업.
```

### 3.6 API 엔드포인트

```
POST   /api/cards/:cardId/subtasks              # 서브태스크 생성
GET    /api/cards/:cardId/subtasks              # 서브태스크 목록 조회
PATCH  /api/cards/:cardId/subtasks/reorder      # 서브태스크 순서 변경
GET    /api/cards/:cardId/subtask-progress      # 서브태스크 진행률 조회

# 서브태스크 자체는 Card이므로 기존 Card API로 수정/삭제/이동
# GET /api/cards/:id 응답에 parentCardId, subtasks[] 포함
```

---

## 4. 스레드형 코멘트

### 4.1 누락 근거

> **Slack 벤치마크**: Slack의 Thread는 채널의 메시지 흐름을 방해하지 않으면서 특정 주제에 대한 심층 논의를 가능하게 하는 핵심 기능이다.

**기존 FRD 상태**: 코멘트(CM-001~006)가 플랫(flat) 구조로만 정의되어 있다. 카드 하나에 코멘트가 누적되면 "API 스펙 논의", "디자인 피드백", "배포 이슈" 등 서로 다른 주제의 코멘트가 시간순으로 뒤섞여 맥락 추적이 불가능해진다.

### 4.2 기능 상세

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| TH-001 | 코멘트 답글(Thread) | 기존 코멘트에 대한 답글 작성. `parentCommentId`로 참조. 답글은 원본 코멘트 아래 들여쓰기로 표시. 답글에도 마크다운, @멘션 지원 | P1 |
| TH-002 | 스레드 접기/펼치기 | 답글이 2개 이상인 스레드는 기본 접힘 상태. "3개의 답글 보기" 클릭으로 펼침. 접힌 상태에서 최신 답글 1개는 미리보기 표시 | P1 |
| TH-003 | 스레드 알림 | 내가 작성한 코멘트에 답글이 달리거나, 내가 답글을 단 스레드에 새 답글이 추가되면 알림. 기존 알림 시스템(NF-*)과 통합 | P1 |

### 4.3 객체 모델 변경

```
Comment (기존 모델에 필드 추가) {
  ...기존 필드 유지...
  
  // 추가 필드
  parentCommentId: FK → Comment? (null = 최상위 코멘트, 루트)
  replyCount: int (답글 수, 캐시용, 접기/펼치기 UI에 사용)
  threadParticipants: User[] (스레드 참여자, 알림 대상)
}

// 관계
Comment 1 ──< N Comment (parentCommentId)
  - 1단계 답글만 허용 (답글의 답글 불가, UX 복잡성 방지)
  - 답글 정렬: 생성일 오름차순 (오래된 것부터)
```

### 4.4 UI 워크플로우

```
카드 상세 모달 - 코멘트 섹션 (스레드 적용):

── 활동 ──
[코멘트 | 활동로그] 탭 전환

👤 김개발 (14:30)                              [답글] [📌고정]
  "API 인증 방식을 JWT에서 Session으로 변경하는 건 어떨까요?"
  │
  ├─ 👤 이디자인 (14:45)                           [답글]
  │    "세션은 스케일링 이슈가 있어서 JWT 유지가 좋을 것 같습니다"
  │
  ├─ 👤 김개발 (14:52)                             [답글]
  │    "Redis 세션 스토어를 쓰면 스케일링 문제는 해결됩니다"
  │
  └─ 👤 박매니저 (15:10)                            [답글]
       "JWT로 가되 Refresh Token 로테이션 적용합시다"

👤 이디자인 (15:30)                             [답글] [📌고정]
  "목업 첨부합니다. 피드백 부탁드립니다"
  📎 login-mockup-v2.png
  │
  └─ ▼ 2개의 답글 보기                     ← 접힌 스레드
     └─ 최신: 👤 김개발 "헤더 색상만 변경 부탁..."

┌───────────────────────────────────┐
│ 코멘트 입력 (마크다운)             │
│ @멘션 가능                        │
└───────────────────────────────────┘
[전송]
```

---

## 5. 고정(Pin) 시스템

### 5.1 누락 근거

> **Slack 벤치마크**: Slack의 Pinned Items는 채널에서 중요한 메시지를 상단에 고정하여 정보 접근성을 확보하는 핵심 기능이다.

**기존 FRD 상태**: 보드 즐겨찾기(BD-006)만 존재하며, 카드 내부의 코멘트/첨부파일 고정, 보드 레벨 공지 고정, 사용자별 카드 북마크가 모두 부재하다. 코멘트가 쌓일수록 초기의 핵심 결정사항이나 중요 참조 파일이 묻히는 문제가 발생한다.

### 5.2 기능 상세

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| PN-001 | 코멘트 고정 | 카드 내 중요 코멘트를 상단 "고정된 항목" 섹션에 Pin. 카드당 최대 5개. 고정/해제는 코멘트 작성자 또는 보드 관리자만 가능 | P1 |
| PN-002 | 보드 공지 고정 | 보드 상단에 공지사항 배너 표시. 마크다운 지원. "팀 규칙", "이번 스프린트 목표", "주의사항" 등 게시. 보드 관리자만 설정 가능. 접기 가능하되 접어도 아이콘으로 존재 표시 | P1 |
| PN-003 | 카드 개인 북마크 | 사용자별 카드 북마크 (보드 즐겨찾기와 별도). 헤더에 북마크 아이콘, 클릭 시 북마크된 카드 목록 패널. 보드/워크스페이스를 가로질러 북마크 가능 | P1 |

### 5.3 객체 모델

```
PinnedComment {
  id: cuid
  commentId: FK → Comment
  cardId: FK → Card
  pinnedBy: FK → User
  pinnedAt: DateTime
}

BoardAnnouncement {
  id: cuid
  boardId: FK → Board
  content: string (마크다운, 최대 2000자)
  isActive: boolean
  createdBy: FK → User
  createdAt, updatedAt
}

CardBookmark {
  id: cuid
  userId: FK → User
  cardId: FK → Card
  createdAt: DateTime
}
// 유니크 인덱스: (userId, cardId)
```

### 5.4 UI 워크플로우

```
카드 상세 모달 - 고정된 코멘트:

┌─────────────────────────────────────────────────┐
│ 📌 고정된 항목 (2)                          [▲] │
│ ┌─────────────────────────────────────────────┐ │
│ │ 👤 박매니저 (02-20)                  [해제] │ │
│ │ "JWT + Refresh Token 로테이션으로 최종 결정" │ │
│ ├─────────────────────────────────────────────┤ │
│ │ 👤 이디자인 (02-18)                  [해제] │ │
│ │ "최종 확정 목업: login-final.png"           │ │
│ └─────────────────────────────────────────────┘ │
│                                                  │
│ ── 코멘트 (시간순) ──                            │
│ ...일반 코멘트들...                               │
└──────────────────────────────────────────────────┘


보드 공지:

┌─────────────────────────────────────────────────────────┐
│ 📢 이번 스프린트 목표: 인증 모듈 완성 + 보드 CRUD API    [▼접기]│
│    WIP 제한 준수, 코드 리뷰 필수, 마감: 03-07           │
└─────────────────────────────────────────────────────────┘
│ To Do        │ In Progress   │ Review        │ Done    │
│ ...          │ ...           │ ...           │ ...     │


헤더 - 북마크:

┌──────────────────────────────────────────┐
│ 🏠 KanFlow   [🔍] [🔔3] [⭐2] [👤]     │  ← ⭐ = 북마크
└──────────────────────────────────────────┘
                          │
                          ▼ (클릭 시)
                ┌──────────────────────┐
                │ ⭐ 내 북마크 (2)      │
                │ KF-042 사용자 인증    │
                │  └ 보드A > In Prog   │
                │ KF-089 대시보드 설계  │
                │  └ 보드B > To Do     │
                └──────────────────────┘
```

---

## 6. 리치 블록 에디터

### 6.1 누락 근거

> **Notion 벤치마크**: Notion의 Block Editor는 텍스트, 헤딩, 토글, 콜아웃, 코드 블록, 테이블, 임베드 등을 블록 단위로 조합하는 구조화된 문서 작성 도구이다.

**기존 FRD 상태**: 카드 설명(CD-005)과 코멘트(CM-001)에서 "마크다운 지원"으로만 명시. 기본 마크다운은 토글(접기/펼치기), 콜아웃(주의사항 강조), 구문 강조 코드 블록을 지원하지 않는다. 칸반 카드의 설명은 단순 메모가 아니라 **작업 명세서** 역할을 하므로 구조화된 문서 작성 능력이 필요하다.

### 6.2 기능 상세

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| RE-001 | 토글 블록 | 접기/펼치기 가능한 섹션. 긴 내용(참고 자료, 상세 스펙)을 접어서 가독성 확보. 마크다운 확장 문법: `:::toggle 제목` | P2 |
| RE-002 | 콜아웃 블록 | 주의사항(⚠️), 팁(💡), 정보(ℹ️), 경고(🚨) 등 강조 박스. 배경색 + 아이콘으로 시각적 구분. 마크다운 확장 문법: `:::callout[warn]` | P2 |
| RE-003 | 코드 블록 구문 강조 | 언어별 syntax highlighting 지원 (JavaScript, TypeScript, Python, SQL, JSON, YAML, Bash 등). Prism.js 또는 highlight.js 기반. 코드 블록 상단에 언어 선택 + 복사 버튼 | P1 |
| RE-004 | 테이블 블록 | 카드 설명 내 간단한 테이블 삽입. 행/열 추가/삭제. 마크다운 테이블 문법 호환 + WYSIWYG 편집 | P2 |
| RE-005 | 슬래시 명령 에디터 | 설명 편집 중 `/` 입력 시 블록 타입 선택 팝업: /heading, /toggle, /callout, /code, /table, /checklist, /divider. Notion 스타일 UX | P2 |

### 6.3 에디터 아키텍처

```
에디터 라이브러리 선택 근거:

┌────────────────────────────────────────────────────────────┐
│ Tiptap (ProseMirror 기반) 채택 권장                         │
│                                                             │
│ 이유:                                                       │
│ 1. 블록 기반 에디터 확장이 용이 (Extension 시스템)            │
│ 2. 마크다운 ↔ HTML 양방향 변환 지원                          │
│ 3. 코드 블록, 테이블 등 공식 Extension 존재                  │
│ 4. React 통합 우수 (@tiptap/react)                          │
│ 5. Collaboration 확장 (향후 실시간 동시 편집 대비)            │
│                                                             │
│ 대안 비교:                                                   │
│ - Slate.js: 유연하지만 학습 곡선 높음, 블록 확장 직접 구현    │
│ - Draft.js: Meta 유지보수 중단, 레거시                       │
│ - Lexical: Meta 후속, 아직 생태계 미성숙                     │
│ - Quill: 마크다운 호환 약함, 커스터마이징 제한적              │
└────────────────────────────────────────────────────────────┘

데이터 저장 전략:
  - DB 저장: 마크다운 원문 (기존 호환성 유지)
  - 렌더링: Tiptap이 마크다운 파싱 → 블록 렌더링
  - 확장 블록(토글, 콜아웃): 커스텀 마크다운 확장 문법으로 저장
    예: :::toggle[제목]\n내용\n:::
    예: :::callout[warn]\n주의사항\n:::
```

### 6.4 슬래시 명령 UI

```
카드 설명 편집 중 "/" 입력:

┌─────────────────────────────────┐
│ 여기에 설명을 입력하세요...      │
│ /                               │
│ ┌───────────────────────────┐   │
│ │ 🔤 Heading 1              │   │
│ │ 🔤 Heading 2              │   │
│ │ 🔤 Heading 3              │   │
│ │ ─── 블록 ──────────────── │   │
│ │ ▶ Toggle (접기/펼치기)     │   │
│ │ 💡 Callout (강조 박스)     │   │
│ │ 💻 Code Block (코드)      │   │
│ │ 📊 Table (테이블)         │   │
│ │ ☑ Checklist              │   │
│ │ ── Divider (구분선)       │   │
│ └───────────────────────────┘   │
└─────────────────────────────────┘
```

---

## 7. Webhook / 외부 시스템 연동

### 7.1 누락 근거

> **Slack 벤치마크**: Slack의 Incoming/Outgoing Webhooks와 App Integration은 외부 시스템과의 양방향 연동을 가능하게 하는 핵심 인프라이다.

**기존 FRD 상태**: 실시간 동기화(RT-001~004)는 KanFlow 내부의 WebSocket 기반 동기화만 정의한다. 자동화 규칙 엔진(AT-001~014)의 액션도 내부 액션(카드 이동, 담당자 할당, 알림 등)만 정의하고, **외부 HTTP 호출을 액션으로 지원하지 않는다.**

자체 호스팅 칸반 보드가 조직의 기존 도구(CI/CD, Git, 채팅, 모니터링 등)와 연동되지 않으면 고립된 도구가 되어 채택률이 급격히 떨어진다.

### 7.2 기능 상세

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| WH-001 | Outgoing Webhook | 보드 내 이벤트 발생 시 등록된 외부 URL로 HTTP POST 전송. 지원 이벤트: 카드 생성/이동/완료/삭제, 코멘트 추가, 마감일 초과, 담당자 변경. Payload는 JSON 형식으로 이벤트 타입, 카드 데이터, 변경 내역 포함 | P1 |
| WH-002 | Incoming Webhook | 외부 시스템에서 KanFlow에 요청을 보내 카드 생성/수정/이동이 가능한 REST 엔드포인트. 보드별 고유 Webhook URL 발급. CI/CD에서 빌드 완료 시 카드 자동 이동, GitHub Issue 생성 시 카드 자동 생성 등에 활용 | P1 |
| WH-003 | Webhook 관리 | 보드 설정에서 Webhook 등록/수정/삭제/활성화·비활성화. 이벤트 유형 선택 (구독할 이벤트 체크박스). 최근 실행 로그 조회 (성공/실패, 응답 코드, 소요 시간). 실패 시 재시도 정책 (최대 3회, 지수 백오프) | P1 |
| WH-004 | Webhook 시크릿 | Webhook 요청에 HMAC-SHA256 서명 헤더(`X-KanFlow-Signature`) 포함. 수신 측에서 서명 검증으로 요청 위변조 방지. 시크릿 키 자동 생성 + 재생성 기능 | P1 |

### 7.3 객체 모델

```
Webhook {
  id: cuid
  boardId: FK → Board
  name: string (1~100자, 예: "Slack 알림", "CI/CD 트리거")
  type: "outgoing" | "incoming"
  
  // Outgoing 전용
  targetUrl: string (외부 URL)
  events: string[] (구독 이벤트 목록)
    // ["card.created", "card.moved", "card.completed",
    //  "card.deleted", "comment.created", "card.overdue",
    //  "card.assignee_changed"]
  secret: string (HMAC 시크릿, 자동 생성)
  
  // Incoming 전용  
  webhookUrl: string (자동 생성, /api/webhooks/incoming/:token)
  token: string (UUID, URL에 포함)
  
  // 공통
  isActive: boolean (default: true)
  lastTriggeredAt: DateTime?
  createdBy: FK → User
  createdAt, updatedAt
}

WebhookLog {
  id: cuid
  webhookId: FK → Webhook
  event: string (이벤트 타입)
  requestPayload: JSON
  responseStatus: int? (HTTP 상태 코드)
  responseBody: string? (최대 1000자, 디버깅용)
  success: boolean
  duration: int (ms)
  retryCount: int
  createdAt: DateTime
}
```

### 7.4 Outgoing Webhook Payload 예시

```json
{
  "event": "card.moved",
  "timestamp": "2026-02-24T14:30:00Z",
  "board": {
    "id": "clxx...",
    "title": "Sprint 3"
  },
  "card": {
    "id": "clxx...",
    "number": "KF-042",
    "title": "사용자 인증 구현",
    "assignees": ["김개발", "이디자인"]
  },
  "change": {
    "field": "column",
    "from": { "id": "clxx...", "title": "In Progress" },
    "to": { "id": "clxx...", "title": "Done" }
  },
  "actor": {
    "id": "clxx...",
    "name": "김개발"
  }
}
```

### 7.5 아키텍처

```
Outgoing Webhook 처리 흐름:

  [이벤트 발생]
       │
       ▼
  ┌──────────────────┐
  │ EventEmitter     │  기존 이벤트 시스템
  │ (NestJS)         │
  └────────┬─────────┘
           │
           ▼
  ┌──────────────────┐
  │ WebhookService   │  구독 Webhook 조회
  │                  │  → 매칭되는 Webhook 필터
  └────────┬─────────┘
           │
           ▼
  ┌──────────────────┐
  │ BullMQ Queue     │  비동기 처리 (API 응답 지연 방지)
  │ "webhook-delivery"│
  └────────┬─────────┘
           │
           ▼
  ┌──────────────────┐     ┌──────────────────┐
  │ WebhookWorker    │────▶│ 외부 서비스       │
  │ - HMAC 서명 생성  │     │ (Slack, CI/CD 등) │
  │ - HTTP POST 전송  │     └──────────────────┘
  │ - 로그 기록       │
  │ - 실패 시 재시도   │
  └──────────────────┘


Incoming Webhook 처리 흐름:

  [외부 시스템]
       │ POST /api/webhooks/incoming/:token
       ▼
  ┌──────────────────┐
  │ WebhookController│  토큰 검증 → Webhook 조회
  └────────┬─────────┘
           │
           ▼
  ┌──────────────────┐
  │ WebhookService   │  요청 파싱
  │                  │  → 카드 생성/수정/이동 실행
  └────────┬─────────┘
           │
           ▼
  ┌──────────────────┐
  │ 기존 카드 서비스   │  일반 API와 동일한 로직 재사용
  └──────────────────┘
```

### 7.6 API 엔드포인트

```
# Webhook 관리
POST   /api/boards/:boardId/webhooks              # Webhook 생성
GET    /api/boards/:boardId/webhooks              # Webhook 목록
GET    /api/boards/:boardId/webhooks/:id          # Webhook 상세
PATCH  /api/boards/:boardId/webhooks/:id          # Webhook 수정
DELETE /api/boards/:boardId/webhooks/:id          # Webhook 삭제
POST   /api/boards/:boardId/webhooks/:id/test     # Webhook 테스트 (샘플 이벤트 전송)
POST   /api/boards/:boardId/webhooks/:id/regenerate-secret  # 시크릿 재생성

# Webhook 로그
GET    /api/boards/:boardId/webhooks/:id/logs     # 실행 로그 조회

# Incoming Webhook 수신
POST   /api/webhooks/incoming/:token              # 외부 → KanFlow
```

---

## 8. 사용자 상태 및 프레즌스

### 8.1 누락 근거

> **Slack 벤치마크**: Slack의 커스텀 상태("🏖️ 휴가 중", "🎯 집중 모드")와 온라인/오프라인 프레즌스는 팀원의 현재 가용 상태를 파악하는 핵심 기능이다.

**기존 FRD 상태**: 온라인 사용자 표시(RT-003)로 "현재 같은 보드를 보고 있는 사용자 아바타 표시"만 정의. 사용자의 **커스텀 상태 메시지**, **방해 금지 모드**가 없다. 카드를 할당할 때 담당자가 휴가 중인지, 미팅 중인지 알 수 없어 불필요한 커뮤니케이션이 발생한다.

### 8.2 기능 상세

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| UP-001 | 사용자 커스텀 상태 | 이모지 + 텍스트 상태 설정. 예: "🏖️ 휴가 2/25-3/1", "🎯 집중 모드", "🤒 병가". 만료 시각 설정 가능 (30분/1시간/4시간/오늘 중/특정 날짜). 만료 시 자동 초기화 | P2 |
| UP-002 | 상태 표시 위치 | 다음 위치에 상태 표시: ① 담당자 할당 드롭다운 (이름 옆 상태 텍스트), ② 카드 상세 담당자 영역, ③ 워크스페이스 멤버 목록, ④ 보드 온라인 사용자 영역 | P2 |
| UP-003 | 방해 금지 모드 | 활성화 시 모든 인앱/브라우저 푸시 알림 일시 중지. 상태 자동 설정: "🔇 방해 금지". 기간 설정 가능. DND 중에도 알림은 서버에 저장되며, 해제 시 일괄 표시 | P2 |

### 8.3 객체 모델

```
UserStatus {
  userId: FK → User (PK, 1:1 관계)
  emoji: string? (이모지, 예: "🏖️")
  text: string? (상태 텍스트, 최대 100자)
  expiresAt: DateTime? (만료 시각, null = 수동 해제까지 유지)
  isDnd: boolean (방해 금지 모드, default: false)
  dndExpiresAt: DateTime? (DND 만료 시각)
  updatedAt: DateTime
}
```

### 8.4 UI 워크플로우

```
상태 설정 (헤더 프로필 클릭):

┌────────────────────────────────┐
│ 👤 김개발                      │
│ ┌────────────────────────────┐ │
│ │ 😀 상태를 설정하세요...     │ │
│ └────────────────────────────┘ │
│                                │
│ 빠른 선택:                     │
│ 📍 회의 중        [30분 ▾]    │
│ 🏖️ 휴가           [날짜 ▾]    │
│ 🎯 집중 모드      [2시간 ▾]   │
│ 🤒 병가           [오늘 ▾]    │
│                                │
│ ── 또는 ──                     │
│ [이모지 선택] [직접 입력     ] │
│ 만료: [안 함 ▾]               │
│                                │
│ ☐ 방해 금지 모드 켜기          │
│                                │
│        [취소] [저장]           │
└────────────────────────────────┘


담당자 할당 드롭다운에서 상태 표시:

┌────────────────────────────────┐
│ 담당자 추가:                    │
│ ┌────────────────────────────┐ │
│ │ 👤 김개발  🏖️ 휴가 2/25-3/1│ │  ← 휴가 중 표시
│ │ 👤 이디자인 🟢 온라인       │ │  ← 온라인 (상태 없음)
│ │ 👤 박매니저 🎯 집중 모드    │ │  ← 집중 중 표시
│ │ 👤 최주니어 ⚫ 오프라인     │ │  ← 오프라인
│ └────────────────────────────┘ │
└────────────────────────────────┘
```

---

## 9. 공유 링크 / 게스트 접근

### 9.1 누락 근거

> **Notion 벤치마크**: Notion의 "Share to web" 기능은 페이지를 읽기 전용 공개 링크로 만들어 외부 이해관계자에게 공유하는 핵심 기능이다. Slack에서도 채널에 외부 게스트를 초대하는 기능이 있다.

**기존 FRD 상태**: 역할 기반 접근 제어(AU-007)로 Admin/Member/Viewer만 정의. **비회원 외부 공유 메커니즘이 없다.** 클라이언트에게 프로젝트 진행 상황을 보여주거나, 경영진에게 대시보드를 공유하려면 반드시 KanFlow 계정이 필요한 상태이다.

자체 호스팅 환경에서 외부 이해관계자 접근은 공유 링크(토큰 기반)가 가장 합리적이며, 보안을 위해 만료일과 즉시 비활성화 기능이 필수이다.

### 9.2 기능 상세

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| SL-001 | 보드 공유 링크 | 읽기 전용 public URL 생성. 토큰 기반 (`/shared/board/:token`). 만료일 설정 (1일/7일/30일/무제한). 비밀번호 보호 옵션. 링크 접근 시 인증 없이 보드 뷰 표시 (편집 불가, 드래그 불가) | P1 |
| SL-002 | 카드 공유 링크 | 개별 카드의 읽기 전용 공유 URL. 카드 상세 정보 표시 (설명, 체크리스트, 코멘트 등). 민감 정보(코멘트) 포함/제외 옵션 | P2 |
| SL-003 | 게스트 초대 | 이메일로 특정 보드에 Viewer 권한 초대. 회원가입 없이 이메일 인증만으로 접근 가능. 게스트는 보드 읽기 + 코멘트 작성만 가능 (편집 불가). 보드 관리자가 게스트 목록 관리 | P1 |
| SL-004 | 공유 링크 비활성화 | 생성된 공유 링크를 즉시 무효화. 비활성화 후 접근 시 "링크가 만료되었습니다" 표시. 보드 설정에서 모든 공유 링크 일괄 비활성화 가능 | P1 |

### 9.3 객체 모델

```
SharedLink {
  id: cuid
  token: string (UUID v4, URL에 사용)
  type: "board" | "card"
  targetId: string (boardId 또는 cardId)
  
  // 접근 제어
  password: string? (bcrypt 해시, null = 비밀번호 없음)
  expiresAt: DateTime? (null = 무제한)
  isActive: boolean (default: true)
  
  // 옵션
  includeComments: boolean (default: true)
  
  // 메타
  createdBy: FK → User
  accessCount: int (조회 수 통계)
  lastAccessedAt: DateTime?
  createdAt, updatedAt
}

GuestAccess {
  id: cuid
  email: string
  boardId: FK → Board
  inviteToken: string (이메일 인증용)
  isVerified: boolean (이메일 인증 완료 여부)
  
  // 권한
  canComment: boolean (default: true)
  
  // 메타
  invitedBy: FK → User
  expiresAt: DateTime? (게스트 접근 만료일)
  lastAccessedAt: DateTime?
  createdAt, updatedAt
}
```

### 9.4 보안 아키텍처

```
공유 링크 접근 흐름:

  [외부 사용자] → /shared/board/:token
       │
       ▼
  ┌──────────────────┐
  │ SharedLinkGuard  │  ← 전용 Guard (JwtAuthGuard 아님)
  │                  │
  │ 1. 토큰 유효성   │  → SharedLink 테이블 조회
  │ 2. 활성 상태     │  → isActive = true
  │ 3. 만료일 확인   │  → expiresAt > now()
  │ 4. 비밀번호 확인  │  → password 매칭 (설정된 경우)
  └────────┬─────────┘
           │ 통과
           ▼
  ┌──────────────────┐
  │ SharedBoardView  │  읽기 전용 보드 렌더링
  │                  │  - 드래그 비활성
  │                  │  - 편집 버튼 숨김
  │                  │  - 설정 메뉴 숨김
  └──────────────────┘


게스트 접근 흐름:

  [관리자] → 게스트 초대 (이메일 입력)
       │
       ▼
  ┌──────────────────┐
  │ 이메일 발송       │  초대 링크 포함
  └────────┬─────────┘
           │
           ▼
  [게스트] → 초대 링크 클릭 → 이메일 인증
       │
       ▼
  ┌──────────────────┐
  │ 게스트 세션 생성   │  제한된 JWT (boardId 바인딩)
  │                  │  → 해당 보드만 접근 가능
  │                  │  → 읽기 + 코멘트만 가능
  └──────────────────┘
```

### 9.5 API 엔드포인트

```
# 공유 링크
POST   /api/boards/:boardId/shared-links             # 공유 링크 생성
GET    /api/boards/:boardId/shared-links             # 공유 링크 목록
PATCH  /api/boards/:boardId/shared-links/:id         # 공유 링크 수정 (비활성화 등)
DELETE /api/boards/:boardId/shared-links/:id         # 공유 링크 삭제

# 공유 링크 접근 (인증 불필요)
GET    /api/shared/board/:token                      # 공유 보드 조회
POST   /api/shared/board/:token/verify-password      # 비밀번호 검증
GET    /api/shared/card/:token                       # 공유 카드 조회

# 게스트 관리
POST   /api/boards/:boardId/guests                   # 게스트 초대
GET    /api/boards/:boardId/guests                   # 게스트 목록
DELETE /api/boards/:boardId/guests/:id               # 게스트 접근 제거
POST   /api/guests/verify/:inviteToken               # 게스트 이메일 인증
```

---

## 10. 기존 FRD 통합 영향 분석

### 10.1 기존 기능과의 의존 관계

```
추가 기능 → 기존 FRD 의존 관계 맵

┌──────────────────┐     ┌──────────────────────────────────┐
│ CT (카드 템플릿)  │────▶│ CD-001~020 (카드 관리)           │
│                  │────▶│ CK-001~009 (체크리스트)          │
│                  │────▶│ LB-001~006 (라벨)               │
└──────────────────┘     └──────────────────────────────────┘

┌──────────────────┐     ┌──────────────────────────────────┐
│ ST (서브태스크)   │────▶│ CD-001~020 (카드 관리) → 모델 확장│
│                  │────▶│ LK-001~004 (카드 연결) → 공존    │
│                  │────▶│ CK-001~009 (체크리스트) → 공존   │
│                  │────▶│ DD-001~012 (드래그앤드롭) → 연동 │
└──────────────────┘     └──────────────────────────────────┘

┌──────────────────┐     ┌──────────────────────────────────┐
│ TH (스레드코멘트) │────▶│ CM-001~006 (코멘트) → 모델 확장  │
│                  │────▶│ NF-001~007 (알림) → 스레드 알림  │
└──────────────────┘     └──────────────────────────────────┘

┌──────────────────┐     ┌──────────────────────────────────┐
│ PN (고정 시스템)  │────▶│ CM-001~006 (코멘트) → Pin 필드   │
│                  │────▶│ BD-006 (즐겨찾기) → 공존         │
│                  │────▶│ NF-001~007 (알림) → 공지 알림    │
└──────────────────┘     └──────────────────────────────────┘

┌──────────────────┐     ┌──────────────────────────────────┐
│ RE (리치 에디터)  │────▶│ CD-005 (카드 설명) → 에디터 교체  │
│                  │────▶│ CM-001 (코멘트) → 에디터 공유    │
└──────────────────┘     └──────────────────────────────────┘

┌──────────────────┐     ┌──────────────────────────────────┐
│ WH (Webhook)     │────▶│ AT-001~014 (자동화) → 액션 확장   │
│                  │────▶│ AL-001~004 (활동 로그) → 이벤트  │
│                  │────▶│ RT-001~004 (실시간) → 이벤트 소스│
└──────────────────┘     └──────────────────────────────────┘

┌──────────────────┐     ┌──────────────────────────────────┐
│ UP (사용자 상태)  │────▶│ RT-003 (온라인 표시) → 확장      │
│                  │────▶│ NF-001~007 (알림) → DND 연동    │
│                  │────▶│ AU-006 (프로필) → 상태 필드 추가 │
└──────────────────┘     └──────────────────────────────────┘

┌──────────────────┐     ┌──────────────────────────────────┐
│ SL (공유 링크)   │────▶│ AU-007 (RBAC) → Guest 역할 추가  │
│                  │────▶│ BD-009 (보드 권한) → 공유 설정   │
│                  │────▶│ NF-001~007 (알림) → 초대 알림   │
└──────────────────┘     └──────────────────────────────────┘
```

### 10.2 DB 스키마 영향

```
새 테이블 (6개):
  - CardTemplate
  - PinnedComment
  - BoardAnnouncement
  - CardBookmark
  - SharedLink
  - GuestAccess
  - WebhookLog

기존 테이블 필드 추가 (4개):
  - Card: + parentCardId, subtaskOrder
  - Comment: + parentCommentId, replyCount
  - User: + UserStatus (1:1 관계 또는 임베딩)
  - Webhook (기존 AT 테이블과 별도, 신규)

Prisma 마이그레이션 필요: 7~10개 마이그레이션 파일 예상
```

### 10.3 기존 FRD 수정 필요 사항

```
기존 FRD 항목 중 수정/확장이 필요한 항목:

1. CD-003 (카드 상세 모달)
   - 서브태스크 섹션 추가
   - 고정된 코멘트 섹션 추가
   - "템플릿으로 저장" 액션 추가

2. CM-001~006 (코멘트)
   - parentCommentId 필드 추가 (스레드)
   - Pin 기능 추가

3. AT-001~014 (자동화 규칙 엔진)
   - 액션 유형에 "Webhook 호출" 추가 (AT-015)
   - 트리거에 "서브태스크 전체 완료" 추가

4. AU-007 (역할)
   - Guest 역할 추가 (읽기 + 코멘트만)

5. NF-001~007 (알림)
   - 스레드 답글 알림 추가
   - DND 모드 연동
   - 게스트 초대 알림 추가

6. 카드 상세 모달 레이아웃 (§4.2)
   - 서브태스크, 고정 코멘트, 스레드 반영하여 레이아웃 업데이트
```

---

## 11. 구현 로드맵 제안

### 11.1 우선순위 기반 스프린트 배정

```
기존 FRD 스프린트와의 통합을 고려한 배정:

Phase A - P1 핵심 (기존 P0/P1과 병행, 초기 스프린트에 배치)
─────────────────────────────────────────────────────────
Sprint 3~4:
  ├── TH-001~003 (스레드형 코멘트)        → 코멘트 모듈 구현 시 함께
  └── PN-001~003 (고정 시스템)            → 코멘트/보드 UI 구현 시 함께

Sprint 4~5:
  ├── ST-001~003 (서브태스크)             → 카드 관리 고도화 시
  └── CT-001~003 (카드 템플릿)            → 카드 생성 플로우 확장 시

Sprint 5~6:
  ├── WH-001~004 (Webhook)               → 자동화 엔진 구현 후
  └── SL-001, SL-003~004 (공유 링크)     → 인증 모듈 안정화 후

Phase B - P1 보조 + P2 (중기 스프린트)
─────────────────────────────────────────────────────────
Sprint 7~8:
  ├── RE-003 (코드 블록 구문 강조)        → 에디터 도입 시
  ├── RE-001~002, RE-004~005 (리치 블록)  → Tiptap 에디터 통합
  └── ST-004 (부모 자동 완료)             → 자동화 연계

Sprint 8~9:
  ├── UP-001~003 (사용자 상태)            → 실시간 동기화 안정화 후
  └── SL-002 (카드 공유 링크)             → 보드 공유 안정화 후
```

### 11.2 기술적 선행 조건

```
추가 기능 구현을 위한 기술 선행 조건:

1. 서브태스크 (ST-*)
   선행: Card CRUD 완성 (CD-*), 드래그앤드롭 (DD-*) 안정화
   이유: 서브태스크는 Card 모델 확장이므로 기본 카드가 완성되어야 함

2. 스레드 코멘트 (TH-*)
   선행: Comment CRUD 완성 (CM-*)
   이유: parentCommentId 필드 추가 및 조회 로직 변경

3. Webhook (WH-*)
   선행: 자동화 규칙 엔진 (AT-*), BullMQ 큐 시스템
   이유: 이벤트 발행 → 큐 → 비동기 전송 파이프라인 필요

4. 리치 블록 에디터 (RE-*)
   선행: 카드 설명 (CD-005), 코멘트 (CM-001) 기본 구현
   이유: 기존 마크다운 에디터를 Tiptap으로 교체하는 작업

5. 공유 링크 (SL-*)
   선행: 인증 시스템 (AU-*) 완성, 보드 권한 (BD-009) 완성
   이유: 인증 우회 경로(공유 토큰)의 보안 설계 필요

6. 카드 템플릿 (CT-*)
   선행: 카드 생성 (CD-001~002), 체크리스트 (CK-*), 라벨 (LB-*)
   이유: 템플릿이 카드 구조 전체를 복제하므로 모든 하위 기능 완성 필요
```

### 11.3 추가 기능 통합 후 기능 집계

```
┌─────────────────────────────────────────────────────┐
│           KanFlow 기능 집계 (통합 후)                 │
├──────────┬──────────┬──────────┬────────────────────┤
│ 우선순위  │ 기존 FRD │ 추가 기능 │ 합계               │
├──────────┼──────────┼──────────┼────────────────────┤
│ P0       │ ~45개    │ 0개      │ ~45개              │
│ P1       │ ~55개    │ 22개     │ ~77개              │
│ P2       │ ~40개    │ 7개      │ ~47개              │
│ P3       │ ~5개     │ 0개      │ ~5개               │
├──────────┼──────────┼──────────┼────────────────────┤
│ 총계     │ ~145개   │ 29개     │ ~174개             │
└──────────┴──────────┴──────────┴────────────────────┘
```

---

> **문서 끝**  
> 버전: v1.0 | 작성일: 2026-02-24  
> 추가 기능: 8개 카테고리, 29개 기능 항목  
> 기존 FRD 대비: 카드 템플릿, 서브태스크, 스레드 코멘트, 고정, 리치 에디터, Webhook, 사용자 상태, 공유 링크  
> 통합 시 총 기능: ~174개
