# KanFlow - 칸반 보드 애플리케이션 기능 요구서 & Claude Code 개발 환경 셋업

> **문서명**: 기능 요구서(FRD) + Claude Code 솔로 개발 환경 셋업  
> **버전**: v2.0  
> **작성일**: 2026-02-24  
> **개발 인원**: 1인 (솔로 개발자)  
> **개발 환경**: Claude Code (Subagents + Hooks + Commands + Skills)  
> **근거**: Trello, Jira Kanban, Azure DevOps Boards, KanbanTool, Businessmap 기능 분석 기반  

---

## 목차

### Part 1. 기능 요구서 (FRD)
1. [기능 전체 맵](#1-기능-전체-맵)
2. [보드 관리](#2-보드-관리)
3. [컬럼 관리](#3-컬럼-관리)
4. [카드(태스크) 관리](#4-카드태스크-관리)
5. [스윔레인](#5-스윔레인)
6. [드래그 앤 드롭](#6-드래그-앤-드롭)
7. [라벨 및 분류 시스템](#7-라벨-및-분류-시스템)
8. [WIP 제한 시스템](#8-wip-제한-시스템)
9. [자동화 규칙 엔진](#9-자동화-규칙-엔진)
10. [검색, 필터, 정렬](#10-검색-필터-정렬)
11. [코멘트 및 협업](#11-코멘트-및-협업)
12. [첨부파일 관리](#12-첨부파일-관리)
13. [체크리스트](#13-체크리스트)
14. [마감일 및 시간 관리](#14-마감일-및-시간-관리)
15. [활동 로그 및 이력](#15-활동-로그-및-이력)
16. [알림 시스템](#16-알림-시스템)
17. [보드 뷰 모드](#17-보드-뷰-모드)
18. [카드 에이징](#18-카드-에이징)
19. [워크플로우 자동화 (Butler 스타일)](#19-워크플로우-자동화-butler-스타일)
20. [분석 및 리포팅](#20-분석-및-리포팅)
21. [보드 템플릿](#21-보드-템플릿)
22. [아카이브 시스템](#22-아카이브-시스템)
23. [사용자 인증 및 권한](#23-사용자-인증-및-권한)
24. [워크스페이스 관리](#24-워크스페이스-관리)
25. [실시간 동기화](#25-실시간-동기화)
26. [키보드 단축키](#26-키보드-단축키)
27. [내보내기/가져오기](#27-내보내기가져오기)
28. [보드 설정 및 커스터마이징](#28-보드-설정-및-커스터마이징)
29. [반복 작업 (Recurring Tasks)](#29-반복-작업-recurring-tasks)
30. [카드 연결 및 의존성](#30-카드-연결-및-의존성)

### Part 2. Claude Code 솔로 개발 환경 셋업
31. [Claude Code 확장 기능 체계 이해](#31-claude-code-확장-기능-체계-이해)
32. [CLAUDE.md 프로젝트 컨텍스트](#32-claudemd-프로젝트-컨텍스트)
33. [Subagent 파이프라인 설계](#33-subagent-파이프라인-설계)
34. [Slash Commands 설계](#34-slash-commands-설계)
35. [Skills 설계](#35-skills-설계)
36. [Hooks 설계](#36-hooks-설계)
37. [settings.json 통합 설정](#37-settingsjson-통합-설정)
38. [MCP 서버 연동](#38-mcp-서버-연동)
39. [솔로 개발 오케스트레이션 워크플로우](#39-솔로-개발-오케스트레이션-워크플로우)
40. [토큰 최적화 전략](#40-토큰-최적화-전략)

---

# Part 1. 기능 요구서 (FRD)

## 1. 기능 전체 맵

### 1.1 전체 기능 아키텍처

```
KanFlow 기능 전체 맵
│
├── 🏗️ 구조 (Structure)
│   ├── 워크스페이스 (다중 프로젝트 컨테이너)
│   ├── 보드 (칸반 보드 단위)
│   ├── 컬럼 (워크플로우 스테이지)
│   ├── 스윔레인 (가로 분할, 카테고리/우선순위/팀 구분)
│   └── 카드 (작업 단위)
│
├── 🎯 카드 속성 (Card Properties)
│   ├── 제목 / 설명 (마크다운 지원)
│   ├── 라벨 (색상 + 텍스트, 다중 할당)
│   ├── 담당자 (다중 할당)
│   ├── 우선순위 (Critical / High / Medium / Low)
│   ├── 마감일 (시작일 + 종료일)
│   ├── 예상 시간 / 실제 시간
│   ├── 체크리스트 (다중, 진행률 표시)
│   ├── 첨부파일 (이미지 미리보기, 문서)
│   ├── 코멘트 (멘션, 마크다운)
│   ├── 커스텀 필드 (텍스트, 숫자, 드롭다운, 날짜)
│   ├── 카드 커버 (색상 또는 이미지)
│   ├── 태그 (자유 입력 태그)
│   └── 카드 번호 (자동 증가 ID, KF-001)
│
├── 🔄 인터랙션 (Interaction)
│   ├── 드래그 앤 드롭 (카드, 컬럼, 스윔레인 간)
│   ├── 빠른 편집 (인라인 제목 편집)
│   ├── 카드 상세 모달
│   ├── 키보드 단축키
│   ├── 컨텍스트 메뉴 (우클릭)
│   └── 벌크 액션 (다중 선택 → 일괄 이동/삭제/라벨링)
│
├── 🤖 자동화 (Automation)
│   ├── 규칙 기반 자동화 (트리거 → 조건 → 액션)
│   ├── 카드 자동 이동 (상태 변경 시)
│   ├── 자동 담당자 할당
│   ├── 마감일 자동 설정
│   ├── WIP 제한 초과 경고/차단
│   ├── 카드 에이징 (정체 감지)
│   ├── 반복 작업 자동 생성
│   └── 자동 아카이브
│
├── 📊 분석 (Analytics)
│   ├── 누적 흐름 다이어그램 (CFD)
│   ├── 리드 타임 / 사이클 타임
│   ├── 처리량 (Throughput)
│   ├── 카드 에이징 차트
│   ├── 컬럼별 카드 분포
│   ├── 담당자별 워크로드
│   └── 보드 활동 히트맵
│
├── 🔍 검색/필터 (Search & Filter)
│   ├── 전체 텍스트 검색
│   ├── 라벨/담당자/마감일/우선순위 필터
│   ├── 저장된 필터 (북마크)
│   └── 크로스보드 검색
│
├── 👁️ 뷰 모드 (Views)
│   ├── 칸반 보드 뷰 (기본)
│   ├── 리스트 뷰 (테이블)
│   ├── 캘린더 뷰 (마감일 기준)
│   ├── 타임라인 뷰 (간트 스타일)
│   └── 대시보드 뷰 (통계 집계)
│
├── 🔔 알림 (Notifications)
│   ├── 인앱 알림
│   ├── 브라우저 푸시 알림
│   ├── 이메일 알림 (선택, 사내 SMTP 사용)
│   └── 멘션 알림
│
├── 📦 데이터 관리 (Data Management)
│   ├── 아카이브 (카드/컬럼/보드)
│   ├── 휴지통 (30일 보관 후 영구 삭제)
│   ├── 내보내기 (JSON, CSV)
│   ├── 가져오기 (Trello JSON, CSV)
│   └── 보드 템플릿 (저장/불러오기)
│
└── ⚙️ 시스템 (System)
    ├── 사용자 인증 (JWT + Refresh Token)
    ├── 역할 기반 접근 제어 (RBAC)
    ├── 실시간 동기화 (WebSocket)
    ├── 보드별 설정
    ├── 사용자 개인 설정
    └── API (REST + WebSocket)
```

### 1.2 우선순위 분류 기준

| 등급 | 정의 | 판단 기준 |
|------|------|-----------|
| **P0 (Must Have)** | 칸반 보드의 핵심 기능, 없으면 제품 불가 | Trello 무료 플랜의 기본 기능 |
| **P1 (Should Have)** | 실질적 업무 활용에 필수, 경쟁력 확보 | Trello Standard/Premium 핵심 기능 |
| **P2 (Nice to Have)** | 차별화 기능, 고급 분석 | Jira/KanbanTool의 고급 기능 |
| **P3 (Future)** | 확장 기능, 장기 로드맵 | 향후 버전에서 개발 |

---

## 2. 보드 관리

### 2.1 기능 상세

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| BD-001 | 보드 생성 | 이름, 설명, 배경색/이미지 설정 | P0 |
| BD-002 | 보드 조회 | 보드 목록 + 최근 접근 보드 표시 | P0 |
| BD-003 | 보드 수정 | 이름, 설명, 배경, 공개 범위 수정 | P0 |
| BD-004 | 보드 삭제 | soft delete (휴지통 이동, 30일 후 영구 삭제) | P0 |
| BD-005 | 보드 복제 | 기존 보드 구조(컬럼+스윔레인) 복사, 카드 선택적 복사 | P1 |
| BD-006 | 보드 즐겨찾기 | 사용자별 즐겨찾기 보드 등록/해제, 상단 고정 | P1 |
| BD-007 | 보드 배경 | 단색, 그라데이션, 사용자 업로드 이미지 | P2 |
| BD-008 | 보드 닫기/재개 | 완료된 보드 닫기 → 아카이브 목록에서 재개 가능 | P1 |
| BD-009 | 보드 권한 설정 | 보드별 멤버 추가, 역할(관리자/편집자/뷰어) 할당 | P0 |
| BD-010 | 보드 활동 피드 | 보드 내 모든 활동의 실시간 피드 (사이드 패널) | P1 |

### 2.2 보드 객체 모델

```
Board {
  id: cuid
  title: string (1~100자)
  description: string? (마크다운, 최대 5000자)
  backgroundColor: string (hex)
  backgroundImage: string? (URL)
  isStarred: boolean (사용자별)
  isClosed: boolean
  visibility: "private" | "workspace" (기본: workspace)
  workspaceId: FK
  ownerId: FK
  defaultColumnIds: Column[] (초기 컬럼 구성)
  createdAt, updatedAt
}
```

---

## 3. 컬럼 관리

### 3.1 기능 상세

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| CL-001 | 컬럼 생성 | 제목, 위치(맨 오른쪽 추가), WIP 제한 선택 | P0 |
| CL-002 | 컬럼 수정 | 제목 인라인 편집, WIP 제한 수정, 색상 | P0 |
| CL-003 | 컬럼 삭제 | 카드가 있는 경우: 대상 컬럼 선택 후 이동 또는 전체 삭제 확인 | P0 |
| CL-004 | 컬럼 순서 변경 | 드래그 앤 드롭으로 컬럼 위치 변경 | P0 |
| CL-005 | 컬럼 접기/펼치기 | 컬럼을 최소 너비로 접기 (카드 수만 표시) | P1 |
| CL-006 | 컬럼 헤더 색상 | 컬럼 상단에 색상 스트립 표시 | P1 |
| CL-007 | 컬럼 정책 설명 | 컬럼별 "Definition of Done" 또는 정책 설명 툴팁 | P2 |
| CL-008 | 컬럼 카드 수 표시 | 현재 카드 수 / WIP 제한 표시 (예: "3/5") | P0 |
| CL-009 | 컬럼 전체 아카이브 | 컬럼 내 모든 카드 일괄 아카이브 | P1 |
| CL-010 | 컬럼 정렬 | 컬럼 내 카드를 마감일/우선순위/생성일 기준 정렬 | P1 |

### 3.2 컬럼 타입

```
Column {
  id: cuid
  title: string (1~50자)
  position: float (fractional indexing)
  wipLimit: int? (null = 무제한)
  color: string (hex, 헤더 스트립 색상)
  isCollapsed: boolean (default: false)
  policy: string? (정책 설명, 최대 500자)
  columnType: "normal" | "done" (done 타입은 완료 상태, 분석에 활용)
  boardId: FK
  createdAt, updatedAt
}
```

---

## 4. 카드(태스크) 관리

### 4.1 기능 상세

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| CD-001 | 카드 생성 | 컬럼 하단 "+" 버튼, 제목 입력 즉시 생성 | P0 |
| CD-002 | 카드 빠른 생성 | 제목만 입력 → Enter로 생성 → 바로 다음 카드 입력 가능 | P0 |
| CD-003 | 카드 상세 모달 | 클릭 시 모달 팝업, 모든 속성 편집 | P0 |
| CD-004 | 카드 제목 편집 | 보드 뷰에서 인라인 편집 (더블클릭 또는 연필 아이콘) | P0 |
| CD-005 | 카드 설명 | 마크다운 편집기, 미리보기 토글 | P0 |
| CD-006 | 카드 삭제 | soft delete → 휴지통 | P0 |
| CD-007 | 카드 복사 | 같은 보드/다른 보드로 복사 (체크리스트, 라벨 포함 선택) | P1 |
| CD-008 | 카드 이동 | 드래그 앤 드롭 + 메뉴에서 보드/컬럼 지정 이동 | P0 |
| CD-009 | 카드 커버 | 카드 상단에 색상 바 또는 이미지 썸네일 표시 | P2 |
| CD-010 | 카드 번호 | 보드 내 자동 증가 번호 (KF-001, KF-002...) | P1 |
| CD-011 | 카드 담당자 | 다중 사용자 할당, 아바타 표시 (카드 미리보기에 최대 3개) | P0 |
| CD-012 | 카드 우선순위 | Critical(🔴) / High(🟠) / Medium(🟡) / Low(🟢) | P0 |
| CD-013 | 카드 마감일 | 시작일 + 마감일, 마감 임박(D-3)/초과 시 색상 경고 | P0 |
| CD-014 | 카드 예상 시간 | 예상 소요 시간 입력 (시간 단위) | P2 |
| CD-015 | 카드 실제 시간 | 타이머 또는 수동 입력, 예상 대비 실제 비교 | P2 |
| CD-016 | 카드 커스텀 필드 | 보드 레벨에서 커스텀 필드 정의 (텍스트/숫자/드롭다운/날짜/체크) | P2 |
| CD-017 | 카드 태그 | 자유 입력 태그, 자동완성, 태그 기반 필터 | P1 |
| CD-018 | 카드 위치 기억 | 브라우저 새로고침 후에도 카드 순서 유지 (fractional indexing) | P0 |
| CD-019 | 벌크 선택 | Ctrl/Shift+클릭으로 다중 카드 선택 → 일괄 이동/라벨/삭제 | P1 |
| CD-020 | 카드 미리보기 정보 | 보드 뷰에서 표시할 정보: 제목, 라벨, 담당자, 마감일, 체크리스트 진행률, 첨부 수, 코멘트 수 | P0 |

### 4.2 카드 상세 모달 레이아웃

```
┌─────────────────────────────────────────────────────────────┐
│ [← 보드명 > 컬럼명]                                    [✕] │
│                                                             │
│ 📋 KF-042                                                  │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ [카드 제목 - 인라인 편집 가능]                             │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ ┌─── 좌측 (70%) ──────────────────┐ ┌─── 우측 (30%) ────┐  │
│ │                                 │ │                    │  │
│ │ ── 설명 ──                      │ │ 📌 속성            │  │
│ │ [마크다운 에디터]                 │ │ 상태: In Progress  │  │
│ │ [편집] [미리보기]                │ │ 담당자: 👤 +추가    │  │
│ │                                 │ │ 라벨: 🟥🟦 +추가   │  │
│ │ ── 체크리스트 (2개) ──           │ │ 우선순위: 🔴 Crit  │  │
│ │ ☑ QA 체크리스트 (3/5) ▼        │ │ 마감일: 03-01 ⚠️   │  │
│ │   ✅ 항목1                     │ │ 시작일: 02-20      │  │
│ │   ✅ 항목2                     │ │ 예상시간: 8h       │  │
│ │   ✅ 항목3                     │ │ 실제시간: 5h       │  │
│ │   ☐ 항목4                     │ │ 태그: #API #인증   │  │
│ │   ☐ 항목5                     │ │                    │  │
│ │ ☑ 배포 체크리스트 (0/3) ▼      │ │ ── 액션 ──         │  │
│ │   ☐ 스테이징                   │ │ [이동]             │  │
│ │   ☐ 프로덕션                   │ │ [복사]             │  │
│ │   ☐ 모니터링                   │ │ [아카이브]          │  │
│ │ [+ 체크리스트 추가]             │ │ [삭제]             │  │
│ │                                 │ │ [공유 링크]         │  │
│ │ ── 첨부파일 ──                  │ │                    │  │
│ │ 📎 설계서.pdf (1.2MB)          │ │ ── 연결된 카드 ──   │  │
│ │ 🖼️ mockup.png [미리보기]       │ │ → KF-039 (blocks) │  │
│ │ [+ 파일 추가] [드래그 드롭]     │ │ ← KF-045 (blocked)│  │
│ │                                 │ │ [+ 연결 추가]      │  │
│ │ ── 활동 ──                     │ └────────────────────┘  │
│ │ [코멘트 | 활동로그] 탭 전환     │                          │
│ │                                 │                          │
│ │ 👤 김개발 (14:30)               │                          │
│ │   "API 스펙 확인 부탁드립니다"  │                          │
│ │                                 │                          │
│ │ 🔄 시스템 (14:25)               │                          │
│ │   To Do → In Progress 이동     │                          │
│ │                                 │                          │
│ │ ┌───────────────────────────┐  │                          │
│ │ │ 코멘트 입력 (마크다운)     │  │                          │
│ │ │ @멘션 가능               │  │                          │
│ │ └───────────────────────────┘  │                          │
│ │ [전송]                          │                          │
│ └─────────────────────────────────┘                          │
└─────────────────────────────────────────────────────────────┘
```

---

## 5. 스윔레인

### 5.1 기능 상세

> **근거**: 스윔레인은 Jira, KanbanTool, Azure DevOps 칸반 보드의 핵심 기능으로, 보드를 가로로 분할하여 카테고리/우선순위/팀/클라이언트별 작업을 구분한다. Trello에는 없는 기능이지만 전문 칸반 도구에서는 필수 기능이다.

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| SW-001 | 스윔레인 생성 | 보드에 가로 행 추가, 이름/색상 설정 | P1 |
| SW-002 | 스윔레인 수정 | 이름, 색상, WIP 제한 수정 | P1 |
| SW-003 | 스윔레인 삭제 | 포함된 카드는 기본 스윔레인으로 이동 | P1 |
| SW-004 | 스윔레인 순서 변경 | 드래그 앤 드롭으로 순서 변경 | P1 |
| SW-005 | 스윔레인 접기/펼치기 | 접으면 카드 수만 표시, 보드 공간 절약 | P1 |
| SW-006 | 스윔레인별 WIP 제한 | 스윔레인 내 총 카드 수 제한 | P2 |
| SW-007 | 기본 스윔레인 | 스윔레인 미지정 카드가 들어가는 기본 레인 | P1 |
| SW-008 | 스윔레인 용도 프리셋 | 우선순위별/담당자별/클라이언트별 자동 구성 | P2 |

### 5.2 스윔레인 시각화

```
┌─────────────────────────────────────────────────────────┐
│        │ To Do   │ In Prog  │ Review   │ Done          │
├────────┼─────────┼──────────┼──────────┼───────────────┤
│ 🔴     │ ┌────┐  │ ┌────┐   │          │ ┌────┐        │
│ 긴급   │ │카드│  │ │카드│   │          │ │카드│        │
│ (2/3)  │ └────┘  │ └────┘   │          │ └────┘        │
│ ▼접기  │         │          │          │               │
├────────┼─────────┼──────────┼──────────┼───────────────┤
│ 🟡     │ ┌────┐  │ ┌────┐   │ ┌────┐   │ ┌────┐┌────┐ │
│ 일반   │ │카드│  │ │카드│   │ │카드│   │ │카드││카드│ │
│ (5/8)  │ │    │  │ │    │   │ └────┘   │ └────┘└────┘ │
│        │ └────┘  │ └────┘   │          │               │
│        │ ┌────┐  │          │          │               │
│        │ │카드│  │          │          │               │
│        │ └────┘  │          │          │               │
├────────┼─────────┼──────────┼──────────┼───────────────┤
│ 🟢     │ ┌────┐  │          │          │ ┌────┐        │
│ 나중에 │ │카드│  │          │          │ │카드│        │
│ (2)    │ └────┘  │          │          │ └────┘        │
└────────┴─────────┴──────────┴──────────┴───────────────┘
```

---

## 6. 드래그 앤 드롭

### 6.1 기능 상세

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| DD-001 | 카드 같은 컬럼 내 이동 | 순서 변경, position(float) 업데이트 | P0 |
| DD-002 | 카드 다른 컬럼으로 이동 | 컬럼 간 드래그, WIP 제한 검증 | P0 |
| DD-003 | 카드 스윔레인 간 이동 | 가로 방향 드래그 | P1 |
| DD-004 | 컬럼 순서 변경 | 컬럼 헤더 드래그로 순서 변경 | P0 |
| DD-005 | 스윔레인 순서 변경 | 스윔레인 헤더 드래그로 순서 변경 | P1 |
| DD-006 | 드래그 미리보기 | 드래그 중 카드 고스트 이미지 표시 | P0 |
| DD-007 | 드롭 인디케이터 | 드롭 가능 위치에 빈 슬롯/하이라이트 표시 | P0 |
| DD-008 | WIP 초과 시 시각적 경고 | WIP 초과 컬럼은 빨간 테두리 + 드롭 가능하되 경고 | P1 |
| DD-009 | 낙관적 업데이트 | UI 즉시 반영 → API 호출 → 실패 시 롤백 | P0 |
| DD-010 | 다중 카드 드래그 | 선택된 카드들을 한 번에 드래그 이동 | P2 |
| DD-011 | 터치 디바이스 지원 | 태블릿에서 long-press → 드래그 | P2 |
| DD-012 | 자동 스크롤 | 보드 가장자리에 카드 드래그 시 자동 수평/수직 스크롤 | P0 |

### 6.2 Fractional Indexing 정렬 방식

```
카드 정렬에 Fractional Indexing 사용 (정수 재정렬 회피)

초기 상태:
  카드A: position = 1.0
  카드B: position = 2.0
  카드C: position = 3.0

카드C를 A와 B 사이로 이동:
  카드A: position = 1.0
  카드C: position = 1.5  ← (1.0 + 2.0) / 2
  카드B: position = 2.0

장점: 다른 카드의 position 업데이트 불필요 → DB 쿼리 1회
재정렬: position 차이가 너무 작아지면 (< 0.001) 전체 재정렬
```

---

## 7. 라벨 및 분류 시스템

### 7.1 기능 상세

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| LB-001 | 라벨 생성 | 보드 레벨에서 라벨 생성 (색상 + 이름) | P0 |
| LB-002 | 라벨 색상 | 프리셋 12색 + 커스텀 hex 입력 | P0 |
| LB-003 | 카드에 라벨 할당 | 다중 라벨 할당 가능, 카드 미리보기에 색상 바 표시 | P0 |
| LB-004 | 라벨 필터 | 특정 라벨이 있는 카드만 표시/숨기기 | P0 |
| LB-005 | 라벨 텍스트 표시 토글 | 카드에서 라벨 색상만 또는 텍스트도 표시 (클릭 토글) | P1 |
| LB-006 | 라벨 관리 | 보드 설정에서 라벨 일괄 편집/삭제 | P1 |

### 7.2 기본 라벨 프리셋

```
보드 생성 시 기본 제공 라벨:
  🟢 #4CAF50  "낮은 우선순위"
  🟡 #FFC107  "보통"
  🟠 #FF9800  "높은 우선순위"
  🔴 #F44336  "긴급"
  🔵 #2196F3  "기능"
  🟣 #9C27B0  "버그"
  사용자가 자유롭게 수정/추가/삭제 가능
```

---

## 8. WIP 제한 시스템

### 8.1 기능 상세

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| WP-001 | 컬럼 WIP 제한 설정 | 컬럼 헤더에서 직접 설정 (null = 무제한) | P0 |
| WP-002 | WIP 상태 표시 | 헤더에 "현재/제한" 표시 (예: "3/5"), 초과 시 빨간색 | P0 |
| WP-003 | WIP 초과 시 동작 | 경고 모드(허용하되 경고) vs 차단 모드(드롭 불가) 선택 | P1 |
| WP-004 | 스윔레인 WIP 제한 | 스윔레인별 독립 WIP 제한 | P2 |
| WP-005 | 글로벌 WIP 제한 | 보드 전체 In Progress 카드 수 제한 | P2 |

---

## 9. 자동화 규칙 엔진

### 9.1 기능 상세

> **근거**: Trello의 Butler, Jira의 Automation, KanbanTool의 Process Automation 기능 기반

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| AT-001 | 규칙 생성 | 트리거 → 조건(선택) → 액션 조합 | P1 |
| AT-002 | 트리거: 카드 이동 | 특정 컬럼으로 이동 시 | P1 |
| AT-003 | 트리거: 카드 생성 | 카드 생성 시 | P1 |
| AT-004 | 트리거: 마감일 도래 | 마감 N일 전 / 마감일 당일 / 마감 초과 | P1 |
| AT-005 | 트리거: 체크리스트 완료 | 모든 체크리스트 항목 완료 시 | P2 |
| AT-006 | 트리거: 라벨 변경 | 특정 라벨 추가/제거 시 | P2 |
| AT-007 | 액션: 카드 이동 | 지정 컬럼으로 자동 이동 | P1 |
| AT-008 | 액션: 담당자 할당 | 자동 담당자 할당/제거 | P1 |
| AT-009 | 액션: 라벨 설정 | 라벨 추가/제거 | P1 |
| AT-010 | 액션: 마감일 설정 | 생성일 기준 +N일 자동 설정 | P2 |
| AT-011 | 액션: 알림 전송 | 지정 사용자에게 알림 | P1 |
| AT-012 | 액션: 카드 아카이브 | 자동 아카이브 (예: Done 컬럼 7일 경과) | P2 |
| AT-013 | 규칙 활성/비활성 | 규칙 on/off 토글 | P1 |
| AT-014 | 규칙 실행 로그 | 자동화 규칙 실행 이력 조회 | P2 |

### 9.2 자동화 규칙 예시

```
규칙 1: "Done 자동 완료 처리"
  트리거: 카드가 "Done" 컬럼으로 이동
  액션:
    - 마감일 색상 → 초록 (완료)
    - 완료 날짜 자동 기록
    - 7일 후 자동 아카이브

규칙 2: "긴급 카드 자동 할당"
  트리거: 카드에 "긴급" 라벨 추가
  액션:
    - 스윔레인을 "긴급"으로 변경
    - 보드 관리자에게 알림

규칙 3: "체크리스트 완료 → 다음 단계"
  트리거: 카드의 모든 체크리스트 완료
  조건: 카드가 "In Progress" 컬럼에 있을 때
  액션:
    - "Review" 컬럼으로 자동 이동
```

---

## 10. 검색, 필터, 정렬

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| SF-001 | 보드 내 검색 | 카드 제목 + 설명 실시간 검색, 매칭 카드 하이라이트 | P0 |
| SF-002 | 전체 검색 | 워크스페이스 전체에서 카드 검색 | P1 |
| SF-003 | 라벨 필터 | 라벨별 카드 표시/숨기기 (AND/OR 선택) | P0 |
| SF-004 | 담당자 필터 | 특정 담당자의 카드만 표시 | P0 |
| SF-005 | 마감일 필터 | 마감 임박 / 마감 초과 / 마감일 없음 | P1 |
| SF-006 | 우선순위 필터 | 우선순위별 필터 | P1 |
| SF-007 | 다중 필터 조합 | 라벨 + 담당자 + 마감일 동시 적용 | P1 |
| SF-008 | 필터 저장 | 자주 쓰는 필터 조합을 이름 붙여 저장 | P2 |
| SF-009 | 컬럼 내 정렬 | 마감일순 / 우선순위순 / 생성일순 / 이름순 | P1 |
| SF-010 | 필터 시 비매칭 카드 처리 | 숨기기 또는 흐리게(opacity 30%) 표시 선택 | P1 |

---

## 11. 코멘트 및 협업

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| CM-001 | 코멘트 작성 | 마크다운 지원, 줄바꿈 유지 | P0 |
| CM-002 | 코멘트 수정 | 본인 코멘트만 수정 가능 | P0 |
| CM-003 | 코멘트 삭제 | 본인 코멘트 삭제 (관리자는 모든 코멘트 삭제 가능) | P0 |
| CM-004 | @멘션 | @사용자명으로 멘션 → 해당 사용자에게 알림 | P1 |
| CM-005 | 코멘트 리액션 | 이모지 반응 (👍👎❤️🎉 등) | P2 |
| CM-006 | 코멘트 내 이미지 | 클립보드 붙여넣기로 이미지 첨부 | P2 |

---

## 12. 첨부파일 관리

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| AF-001 | 파일 업로드 | 클릭 선택 + 드래그 앤 드롭 | P1 |
| AF-002 | 이미지 미리보기 | 이미지 파일 썸네일 표시, 클릭 시 라이트박스 | P1 |
| AF-003 | 파일 다운로드 | 개별 파일 다운로드 | P1 |
| AF-004 | 파일 삭제 | 업로더 또는 관리자만 삭제 가능 | P1 |
| AF-005 | 파일 크기 제한 | 개별 파일 최대 50MB, 카드당 총 200MB | P1 |
| AF-006 | 카드 커버로 설정 | 첨부 이미지를 카드 커버 이미지로 지정 | P2 |

---

## 13. 체크리스트

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| CK-001 | 체크리스트 생성 | 카드당 다중 체크리스트, 제목 필수 | P0 |
| CK-002 | 항목 추가/수정/삭제 | 체크리스트 내 항목 관리 | P0 |
| CK-003 | 항목 체크/언체크 | 클릭으로 완료 토글 | P0 |
| CK-004 | 진행률 표시 | 프로그레스 바 + "3/5" 텍스트 | P0 |
| CK-005 | 항목 순서 변경 | 드래그 앤 드롭 | P1 |
| CK-006 | 항목을 카드로 변환 | 체크리스트 항목 → 독립 카드 생성 | P2 |
| CK-007 | 담당자 할당 (항목별) | 체크리스트 개별 항목에 담당자 할당 | P2 |
| CK-008 | 마감일 (항목별) | 체크리스트 개별 항목에 마감일 설정 | P2 |
| CK-009 | 카드 미리보기에 진행률 | 보드 뷰 카드에 체크리스트 진행률 아이콘 표시 | P0 |

---

## 14. 마감일 및 시간 관리

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| DT-001 | 시작일 + 마감일 | 날짜 범위 설정 | P0 |
| DT-002 | 시간 포함 | 마감 시각 설정 가능 (기본: 종일) | P1 |
| DT-003 | 마감 상태 색상 | D-3 이내: 🟡 / 당일: 🟠 / 초과: 🔴 / 완료: 🟢 | P0 |
| DT-004 | 캘린더 뷰 연동 | 마감일이 있는 카드를 캘린더에 표시 | P1 |
| DT-005 | 리마인더 | 마감 N시간 전 알림 (사용자 설정) | P1 |

---

## 15. 활동 로그 및 이력

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| AL-001 | 카드 활동 로그 | 생성, 이동, 수정, 담당자 변경, 라벨 변경 등 모든 변경 기록 | P0 |
| AL-002 | 보드 활동 피드 | 보드 내 모든 카드의 활동을 시간순으로 표시 (사이드 패널) | P1 |
| AL-003 | 사용자별 활동 | 특정 사용자의 활동만 필터링 | P2 |
| AL-004 | 활동 로그 데이터 | action, entityType, entityId, oldValue, newValue, userId, timestamp | P0 |

---

## 16. 알림 시스템

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| NF-001 | 인앱 알림 | 헤더 알림 벨 아이콘, 읽음/안읽음 표시 | P0 |
| NF-002 | 브라우저 푸시 알림 | Web Notification API 활용 | P1 |
| NF-003 | 멘션 알림 | @멘션 시 해당 사용자에게 알림 | P1 |
| NF-004 | 담당 카드 변경 알림 | 내가 담당한 카드에 변경 발생 시 알림 | P1 |
| NF-005 | 마감일 알림 | 마감 임박/초과 시 알림 | P1 |
| NF-006 | 알림 설정 | 사용자별 알림 종류 on/off 설정 | P1 |
| NF-007 | 알림 일괄 읽음 처리 | "모두 읽음" 버튼 | P1 |

---

## 17. 보드 뷰 모드

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| VW-001 | 칸반 보드 뷰 | 기본 뷰, 컬럼+스윔레인+카드 | P0 |
| VW-002 | 리스트(테이블) 뷰 | 카드를 테이블 형태로 표시, 컬럼 정렬/필터 | P1 |
| VW-003 | 캘린더 뷰 | 마감일 기준 월간/주간 캘린더 | P2 |
| VW-004 | 타임라인 뷰 | 시작일-마감일 기반 간트 차트 스타일 | P2 |
| VW-005 | 대시보드 뷰 | 보드 통계 집계 (차트, 숫자 위젯) | P2 |

---

## 18. 카드 에이징

> **근거**: KanbanTool, Trello Power-Up에서 제공하는 기능. 특정 컬럼에 오래 머문 카드를 시각적으로 강조하여 병목 지점을 즉시 파악.

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| AG-001 | 에이징 표시 | 카드가 현재 컬럼에 머문 기간 표시 (배지) | P1 |
| AG-002 | 에이징 시각 효과 | 오래된 카드일수록 투명도 감소 또는 빨간 테두리 | P2 |
| AG-003 | 에이징 임계값 설정 | 보드/컬럼별 경고 기준일 설정 (기본: 3일/7일) | P2 |
| AG-004 | 에이징 차트 | 카드 에이징 분포 시각화 | P2 |

---

## 19. 워크플로우 자동화 (Butler 스타일)

> **근거**: Trello의 Butler 기능. 코드 없이 규칙/버튼/일정 기반 자동화를 정의할 수 있다.

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| BT-001 | 규칙(Rules) | 트리거 → 액션 자동 실행 (§9의 자동화 엔진) | P1 |
| BT-002 | 보드 버튼 | 보드에 커스텀 버튼 추가, 클릭 시 정의된 액션 일괄 실행 | P2 |
| BT-003 | 카드 버튼 | 카드 상세에 커스텀 버튼 추가 (예: "QA 요청" 버튼) | P2 |
| BT-004 | 예약 실행 | Cron 기반: 매일/매주 특정 시각에 규칙 실행 | P2 |

---

## 20. 분석 및 리포팅

> **근거**: Jira의 Kanban 보고서, KanbanTool의 Analytics, Azure DevOps의 CFD

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| RP-001 | 누적 흐름 다이어그램 (CFD) | 시간 경과에 따른 각 컬럼의 카드 수 누적 그래프 | P2 |
| RP-002 | 리드 타임 | 카드 생성 → Done 까지의 총 소요 시간 | P2 |
| RP-003 | 사이클 타임 | 카드 첫 작업 시작 → Done 까지의 소요 시간 | P2 |
| RP-004 | 처리량 (Throughput) | 일/주/월별 완료 카드 수 | P2 |
| RP-005 | 카드 에이징 차트 | 각 컬럼별 카드 체류 시간 분포 | P2 |
| RP-006 | 컬럼별 분포 | 파이 차트: 각 컬럼의 카드 비율 | P1 |
| RP-007 | 담당자별 워크로드 | 담당자별 할당된 카드 수/완료 수 | P2 |
| RP-008 | 보드 활동 히트맵 | 시간대별 보드 활동량 히트맵 | P3 |

---

## 21. 보드 템플릿

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| TM-001 | 시스템 제공 템플릿 | "기본 칸반", "소프트웨어 개발", "버그 트래킹", "콘텐츠 관리" | P1 |
| TM-002 | 사용자 정의 템플릿 | 현재 보드 구조를 템플릿으로 저장 | P1 |
| TM-003 | 템플릿에서 보드 생성 | 템플릿 선택 → 컬럼/스윔레인/라벨 자동 구성 | P1 |

---

## 22. 아카이브 시스템

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| AR-001 | 카드 아카이브 | 카드를 아카이브로 이동 (보드에서 숨김) | P0 |
| AR-002 | 아카이브 조회 | 아카이브된 카드 목록 조회, 검색 | P0 |
| AR-003 | 아카이브 복원 | 아카이브 → 지정 컬럼으로 복원 | P0 |
| AR-004 | 아카이브 영구 삭제 | 아카이브에서 완전 삭제 (관리자만) | P1 |
| AR-005 | 컬럼 전체 아카이브 | Done 컬럼의 모든 카드 일괄 아카이브 | P1 |
| AR-006 | 자동 아카이브 | Done 컬럼에서 N일 경과 카드 자동 아카이브 | P2 |

---

## 23. 사용자 인증 및 권한

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| AU-001 | 회원가입 | 이메일 + 비밀번호 + 이름 | P0 |
| AU-002 | 로그인 | 이메일 + 비밀번호, JWT 발급 | P0 |
| AU-003 | 로그아웃 | Refresh Token 무효화 | P0 |
| AU-004 | 토큰 갱신 | Access Token 만료 시 Refresh Token으로 자동 갱신 | P0 |
| AU-005 | 비밀번호 변경 | 현재 비밀번호 확인 후 변경 | P0 |
| AU-006 | 프로필 수정 | 이름, 아바타 이미지 변경 | P1 |
| AU-007 | 역할(RBAC) | Admin(전체 관리) / Member(편집) / Viewer(읽기) | P0 |

---

## 24. 워크스페이스 관리

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| WS-001 | 워크스페이스 생성 | 이름, 설명 | P0 |
| WS-002 | 멤버 관리 | 추가/제거/역할 변경 | P0 |
| WS-003 | 워크스페이스 설정 | 이름 변경, 기본 라벨 설정 | P1 |
| WS-004 | 다중 워크스페이스 | 사용자별 여러 워크스페이스 참여 | P1 |

---

## 25. 실시간 동기화

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| RT-001 | 카드 이동 동기화 | 다른 사용자의 드래그 즉시 반영 | P1 |
| RT-002 | 카드 수정 동기화 | 제목/설명/라벨 변경 실시간 반영 | P1 |
| RT-003 | 온라인 사용자 표시 | 현재 같은 보드를 보고 있는 사용자 아바타 표시 | P2 |
| RT-004 | 충돌 방지 | 동시 편집 시 마지막 저장 우선 + 알림 | P2 |

---

## 26. 키보드 단축키

| 단축키 | 동작 | 우선순위 |
|--------|------|----------|
| `N` | 새 카드 생성 | P1 |
| `F` | 필터 패널 열기/닫기 | P1 |
| `/` | 검색 포커스 | P1 |
| `Esc` | 모달/패널 닫기 | P0 |
| `?` | 단축키 도움말 | P1 |
| `B` | 보드 목록 사이드바 토글 | P1 |
| `Arrow keys` | 카드 간 포커스 이동 | P2 |
| `Enter` | 포커스된 카드 상세 열기 | P2 |
| `Ctrl+Z` | 마지막 동작 되돌리기 (undo) | P2 |

---

## 27. 내보내기/가져오기

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| IO-001 | JSON 내보내기 | 보드 전체 데이터 JSON 다운로드 | P1 |
| IO-002 | CSV 내보내기 | 카드 목록 CSV 다운로드 | P1 |
| IO-003 | Trello JSON 가져오기 | Trello 내보내기 파일로 보드 생성 | P2 |
| IO-004 | CSV 가져오기 | CSV 파일로 카드 일괄 생성 | P2 |

---

## 28. 보드 설정 및 커스터마이징

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| BS-001 | 보드 배경 | 단색/그라데이션/이미지 | P2 |
| BS-002 | 카드 미리보기 설정 | 보드 뷰에서 카드에 표시할 정보 선택 (라벨/담당자/마감일 등) | P1 |
| BS-003 | 컬럼 기본 너비 | 컬럼 너비 조절 (드래그) | P2 |
| BS-004 | 카드 크기 | 컴팩트/일반/상세 모드 | P2 |
| BS-005 | 보드 설명 (About) | 보드 설명 문서 (팀 규칙, 워크플로우 설명) | P1 |

---

## 29. 반복 작업 (Recurring Tasks)

> **근거**: KanbanTool의 Recurring Tasks Power-Up, ProjectManager의 반복 작업 기능

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| RC-001 | 반복 설정 | 카드에 반복 주기 설정 (매일/매주/매월/커스텀) | P2 |
| RC-002 | 자동 생성 | 주기 도래 시 카드 자동 복제 → 지정 컬럼에 생성 | P2 |
| RC-003 | 반복 관리 | 반복 일시 중지/재개/삭제 | P2 |

---

## 30. 카드 연결 및 의존성

> **근거**: Jira의 Issue Link, KanbanTool의 Task Dependencies

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| LK-001 | 카드 연결 | 카드 간 관계 설정: blocks / is blocked by / relates to | P1 |
| LK-002 | 연결 표시 | 카드 상세에서 연결된 카드 목록 + 상태 표시 | P1 |
| LK-003 | 블로킹 경고 | blocks 관계의 카드가 미완료 시 시각적 경고 | P2 |
| LK-004 | 크로스보드 연결 | 다른 보드의 카드와도 연결 가능 | P2 |

---

## 기능 집계 요약

| 우선순위 | 기능 수 | 설명 |
|----------|---------|------|
| **P0** | ~45개 | MVP 필수, 칸반 보드 기본 동작에 필수 |
| **P1** | ~55개 | 실무 활용 수준, 스프린트 2-5 구현 |
| **P2** | ~40개 | 고급 기능, 차별화 요소 |
| **P3** | ~5개 | 장기 로드맵 |
| **총계** | **~145개** | |

---

---

# Part 2. Claude Code 솔로 개발 환경 셋업

## 31. Claude Code 확장 기능 체계 이해

### 31.1 확장 기능 계층 구조

> **근거**: Claude Code 공식 문서, PubNub 실전 가이드, Trail of Bits 설정 등에서 검증된 체계

```
Claude Code 확장 체계 (솔로 개발자 관점)

┌─────────────────────────────────────────────────────────────┐
│                     CLAUDE.md                                │
│  프로젝트 컨텍스트, 코딩 규칙, 아키텍처 설명                    │
│  → 모든 세션의 기본 컨텍스트로 자동 로드됨                      │
└──────────────────────────┬──────────────────────────────────┘
                           │
        ┌──────────────────┼──────────────────┐
        ▼                  ▼                  ▼
┌──────────────┐  ┌──────────────┐  ┌──────────────┐
│  Subagents   │  │   Commands   │  │    Skills    │
│ (.claude/    │  │ (.claude/    │  │ (.claude/    │
│  agents/)    │  │  commands/)  │  │  skills/)    │
│              │  │              │  │              │
│ 독립 컨텍스트 │  │ 사용자 트리거 │  │ 자동 트리거   │
│ 위임 작업 수행│  │ /command 입력│  │ 설명 매칭 시  │
│ 전문 역할 수행│  │ 워크플로우    │  │ 자동 적용     │
└──────┬───────┘  └──────────────┘  └──────────────┘
       │
       ▼
┌──────────────┐  ┌──────────────┐  ┌──────────────┐
│    Hooks     │  │     MCP      │  │  settings    │
│ (settings    │  │   Servers    │  │   .json      │
│  .json)      │  │              │  │              │
│              │  │ 외부 도구 연결│  │ 권한, 모델,  │
│ 결정론적 제어 │  │ GitHub,DB,   │  │ 환경 변수,   │
│ 자동 포매팅   │  │ 문서 등      │  │ hooks 설정   │
│ 보안 검증     │  │              │  │              │
└──────────────┘  └──────────────┘  └──────────────┘
```

### 31.2 솔로 개발자를 위한 기능 선택 전략

```
❌ 불필요: Agent Teams (여러 컨텍스트 윈도우, 비용 높음, 팀용)
✅ 핵심: Subagents (전문 역할 위임, 컨텍스트 분리)
✅ 핵심: Slash Commands (반복 워크플로우 자동화)
✅ 유용: Skills (코딩 패턴 자동 적용)
✅ 필수: Hooks (코드 품질 자동 보장)
✅ 유용: MCP Servers (외부 도구 통합)
```

---

## 32. CLAUDE.md 프로젝트 컨텍스트

```markdown
# .claude/CLAUDE.md

# KanFlow - 칸반 보드 애플리케이션

## 프로젝트 개요
사내 서버에서 운영되는 자체 호스팅 칸반 보드.
1인 개발, Claude Code로 개발, Docker 기반 운영.

## 기술 스택
- **Frontend**: React 18.3 + TypeScript 5.5 + Vite 5.4
  - UI: Tailwind CSS 3.4 + shadcn/ui
  - DnD: @hello-pangea/dnd 17.x
  - 상태: TanStack Query 5.x (서버) + Zustand 4.5 (클라이언트)
  - 실시간: Socket.io-client 4.7
  - 폼: React Hook Form 7.x + Zod 3.x
- **Backend**: NestJS 10.x + TypeScript 5.5
  - ORM: Prisma 5.x + PostgreSQL 16
  - 캐시: Redis 7.x
  - 인증: JWT (Passport.js)
  - 파일: MinIO (S3 호환)
  - 실시간: Socket.io 4.7
  - 문서: @nestjs/swagger 7.x
- **Infra**: Docker Compose, Nginx

## 프로젝트 구조 (Monorepo - pnpm workspace)
- `apps/frontend/` → React SPA
- `apps/backend/` → NestJS API
- `packages/shared/` → 공유 타입/유효성 검증
- `docker/` → Docker 설정
- `scripts/` → 자동화

## 코딩 규칙
1. TypeScript strict mode 필수
2. 모든 API 엔드포인트에 Swagger 데코레이터
3. 서비스 로직에 단위 테스트 필수 (Jest)
4. 커밋: Conventional Commits
5. 브랜치: main → develop → feature/*
6. position 필드는 fractional indexing 사용
7. 에러는 NestJS HttpException 계열 사용
8. DB 접근은 반드시 Prisma Client를 통해
9. 프론트 컴포넌트는 함수형 + hooks만 사용
10. 인라인 style 금지, Tailwind 유틸리티 사용

## 핵심 명령어
- `pnpm dev` → 개발 서버 (front+back)
- `pnpm build` → 프로덕션 빌드
- `pnpm test` → 테스트
- `pnpm lint:fix` → 린트 자동 수정
- `pnpm db:migrate` → Prisma 마이그레이션
- `pnpm db:seed` → 시드 데이터
- `pnpm docker:dev` → 개발 인프라 (PG, Redis, MinIO)
- `pnpm docker:prod` → 운영 환경 전체

## 개발/운영 포트 분리 (동일 서버)
- Dev: Frontend :3000 / Backend :4000 / PG :5433 / Redis :6380
- Prod: Nginx :80 / PG :5432 / Redis :6379

## 주의사항
- 운영 DB와 개발 DB 혼동 금지
- Prisma 마이그레이션은 반드시 개발 DB에서 먼저
- 파일 업로드는 MinIO 사용 (로컬 디스크 직접 저장 금지)
- WebSocket은 Redis Pub/Sub 기반 (향후 확장 대비)
```

---

## 33. Subagent 파이프라인 설계

### 33.1 솔로 개발자 Subagent 아키텍처

```
솔로 개발 파이프라인 (직렬 실행)

┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  Researcher │────▶│  Architect  │────▶│ Implementer │
│  (조사/분석) │     │  (설계/검증) │     │ (구현/테스트)│
└─────────────┘     └─────────────┘     └──────┬──────┘
                                               │
                                        ┌──────▼──────┐
                                        │  Reviewer   │
                                        │ (코드 리뷰)  │
                                        └─────────────┘

핵심 원칙:
- 각 Subagent는 독립 컨텍스트 → 메인 세션 오염 방지
- 결과만 요약하여 메인 세션에 반환
- 연구/조사 작업은 반드시 Subagent에 위임 (컨텍스트 절약)
```

### 33.2 Subagent 정의 파일

#### researcher (조사 에이전트)

```markdown
# .claude/agents/researcher.md
---
name: researcher
description: >
  코드베이스 조사, 기술 리서치, 의존성 분석을 수행하는 에이전트.
  새 기능 구현 전 기존 코드 패턴 분석, 라이브러리 사용법 조사,
  아키텍처 파악에 사용한다.
tools:
  - Read
  - Glob
  - Grep
  - Bash
  - WebSearch
model: sonnet
---

당신은 시니어 소프트웨어 리서처입니다.

## 역할
- 코드베이스를 분석하여 기존 패턴과 구조를 파악합니다
- 라이브러리 문서를 조사합니다
- 기존 구현과의 일관성을 확인합니다

## 출력 형식
조사 결과를 다음 형식으로 요약하세요:

### 발견 사항
- 기존 코드에서 발견한 패턴 목록

### 관련 파일
- 관련 파일 경로와 역할

### 권장 접근법
- 기존 패턴에 맞는 구현 방법 제안

### 주의사항
- 기존 코드와 충돌 가능성, 영향 범위

절대로 파일을 수정하지 마세요. 읽기 전용으로 조사만 수행합니다.
```

#### architect (설계 에이전트)

```markdown
# .claude/agents/architect.md
---
name: architect
description: >
  기능 설계, API 설계, DB 스키마 설계, 아키텍처 의사결정을 수행하는 에이전트.
  새 기능 구현 전 설계 검증과 ADR(Architecture Decision Record) 작성에 사용한다.
tools:
  - Read
  - Glob
  - Grep
  - Write
model: sonnet
---

당신은 시니어 소프트웨어 아키텍트입니다.

## 역할
- API 엔드포인트 설계 (REST)
- Prisma 스키마 변경사항 설계
- 컴포넌트 구조 설계
- 아키텍처 결정 기록 (ADR)

## 출력 형식

### API 설계
- 엔드포인트, HTTP 메서드, DTO, 응답 스키마

### DB 스키마 변경
- 새 모델/필드, 관계, 인덱스, 마이그레이션 이름

### 프론트엔드 컴포넌트 구조
- 컴포넌트 트리, props 인터페이스, hooks

### 영향 분석
- 변경되는 기존 파일 목록과 변경 범위

### ADR
- 결정 사항, 근거, 대안, 트레이드오프

설계 문서를 `docs/adr/` 디렉토리에 작성하세요.
```

#### implementer (구현 에이전트)

```markdown
# .claude/agents/implementer.md
---
name: implementer
description: >
  실제 코드 구현과 테스트 작성을 수행하는 에이전트.
  architect의 설계 결과를 기반으로 구현한다.
  백엔드와 프론트엔드 모두 구현 가능하다.
tools:
  - Read
  - Write
  - Edit
  - MultiEdit
  - Glob
  - Grep
  - Bash
model: sonnet
hooks:
  PostToolUse:
    - matcher: "Write|Edit|MultiEdit"
      hooks:
        - type: command
          command: "$CLAUDE_PROJECT_DIR/scripts/hooks/lint-changed.sh"
---

당신은 풀스택 시니어 개발자입니다.

## 역할
- NestJS 백엔드 코드 구현 (Module/Controller/Service/DTO)
- React 프론트엔드 코드 구현 (Component/Hook/Store/API)
- 단위 테스트 작성 (Jest)
- Prisma 마이그레이션 실행

## 구현 순서
1. `packages/shared/` 타입/인터페이스 정의
2. `apps/backend/` Prisma 스키마 → 마이그레이션 → Service → Controller → DTO
3. `apps/frontend/` API 클라이언트 → hooks → 컴포넌트
4. 테스트 작성 및 실행

## 코딩 규칙
- CLAUDE.md의 코딩 규칙을 반드시 준수
- 새 파일 생성 시 기존 패턴 일관성 유지
- 구현 완료 후 `pnpm test` 실행하여 기존 테스트 깨지지 않음을 확인
```

#### reviewer (코드 리뷰 에이전트)

```markdown
# .claude/agents/reviewer.md
---
name: reviewer
description: >
  코드 리뷰를 수행하는 에이전트. 품질, 보안, 성능, 일관성을 검증한다.
  읽기 전용으로 동작하며 리뷰 결과만 출력한다.
tools:
  - Read
  - Glob
  - Grep
  - Bash
model: sonnet
---

당신은 시니어 코드 리뷰어입니다.

## 리뷰 체크리스트
1. **타입 안전성**: any 사용 여부, 적절한 타입 정의
2. **에러 처리**: try-catch, HTTP Exception, 에러 전파
3. **보안**: SQL injection, XSS, 인증/인가 검증
4. **성능**: N+1 쿼리, 불필요한 렌더링, 메모이제이션
5. **테스트**: 핵심 로직 테스트 커버리지
6. **일관성**: CLAUDE.md 코딩 규칙 준수 여부
7. **네이밍**: 명확한 변수/함수/파일 이름

## 출력 형식
### 🔴 Critical (반드시 수정)
- 파일:라인 | 이슈 설명 | 수정 제안

### 🟡 Warning (권장 수정)
- 파일:라인 | 이슈 설명 | 수정 제안

### 🟢 Good Practices (잘한 점)
- 파일 | 잘 적용된 패턴

### 📊 요약
- Critical: N개 / Warning: N개
- 전체 품질 점수: A~F

파일을 절대 수정하지 마세요. 리뷰 결과만 출력합니다.
```

---

## 34. Slash Commands 설계

> **근거**: Slash Commands는 사용자가 `/command` 입력으로 명시적 트리거. 반복적 워크플로우에 최적.

### 34.1 핵심 커맨드 목록

```
.claude/commands/
├── setup.md          # 프로젝트 초기 셋업
├── dev.md            # 개발 서버 시작
├── new-feature.md    # 새 기능 개발 파이프라인
├── implement.md      # 설계서 기반 구현
├── review.md         # 코드 리뷰 실행
├── test.md           # 테스트 실행
├── db-migrate.md     # DB 마이그레이션
├── deploy.md         # 운영 배포
├── status.md         # 프로젝트 상태 확인
└── fix.md            # 버그 수정 워크플로우
```

### 34.2 핵심 커맨드 상세

#### /new-feature (새 기능 개발 파이프라인)

```markdown
# .claude/commands/new-feature.md

새 기능 개발 전체 파이프라인을 실행합니다.

## 입력
$ARGUMENTS 에서 기능 설명을 받습니다.

## 실행 순서

### Step 1: 조사 (Researcher Subagent)
researcher 서브에이전트를 사용하여 기존 코드베이스에서 관련 패턴을 분석하세요.
- 관련 기존 코드 파악
- 영향 범위 분석
- 유사 기능 구현 패턴 확인

### Step 2: 설계 (Architect Subagent)
architect 서브에이전트를 사용하여 기능을 설계하세요.
조사 결과를 전달하여:
- API 엔드포인트 설계
- DB 스키마 변경사항 설계
- 프론트 컴포넌트 구조 설계
- ADR 문서 작성 → docs/adr/ 에 저장

### Step 3: 확인
설계 결과를 나에게 보여주고 승인을 기다리세요.
승인 전까지 구현하지 마세요.

### Step 4: 구현 (승인 후)
implementer 서브에이전트를 사용하여 코드를 구현하세요.
구현 순서:
1. packages/shared 타입 정의
2. Prisma 스키마 + 마이그레이션
3. Backend (Service → Controller → DTO → Test)
4. Frontend (API → Hook → Component → Test)

### Step 5: 리뷰
reviewer 서브에이전트를 사용하여 구현된 코드를 리뷰하세요.
Critical 이슈가 있으면 수정 후 다시 리뷰.

### Step 6: 최종 확인
- pnpm test 실행
- pnpm lint 실행
- 결과 보고
```

#### /fix (버그 수정)

```markdown
# .claude/commands/fix.md

버그를 조사하고 수정합니다.

## 입력
$ARGUMENTS 에서 버그 설명을 받습니다.

## 실행 순서

### Step 1: 원인 분석
researcher 서브에이전트를 사용하여 버그 원인을 조사하세요.
- 관련 파일과 코드 흐름 추적
- 에러 로그 분석
- 재현 조건 파악

### Step 2: 수정
원인 분석 결과를 바탕으로 직접 수정하세요.
- 최소한의 변경으로 수정
- 회귀 테스트 작성

### Step 3: 검증
- pnpm test 실행
- 수정 내역과 테스트 결과 보고
```

#### /status (상태 확인)

```markdown
# .claude/commands/status.md

프로젝트 현재 상태를 종합 보고합니다.

## 확인 항목
1. Git 상태 (현재 브랜치, uncommitted changes, 최근 커밋 5개)
2. Docker 서비스 상태 (개발/운영 컨테이너 헬스)
3. 테스트 결과 요약
4. 린트 이슈 수
5. Prisma 마이그레이션 상태
6. TODO/FIXME 코멘트 수

각 항목을 확인하고 요약 보고서를 작성하세요.
```

---

## 35. Skills 설계

> **근거**: Skills는 설명(description) 매칭으로 자동 트리거. 특정 작업 컨텍스트에서 자동으로 코딩 패턴/규칙 적용.

```
.claude/skills/
├── nestjs-module/
│   └── SKILL.md      # NestJS 모듈 생성 패턴
├── react-component/
│   └── SKILL.md      # React 컴포넌트 생성 패턴
├── prisma-migration/
│   └── SKILL.md      # Prisma 마이그레이션 패턴
├── api-endpoint/
│   └── SKILL.md      # REST API 엔드포인트 패턴
└── dnd-feature/
    └── SKILL.md      # DnD 기능 구현 패턴
```

#### NestJS 모듈 스킬 예시

```markdown
# .claude/skills/nestjs-module/SKILL.md
---
name: nestjs-module
description: >
  NestJS 모듈, 컨트롤러, 서비스를 생성할 때 사용.
  Module, Controller, Service, DTO 파일을 KanFlow 프로젝트의
  패턴에 맞게 생성한다.
---

# NestJS 모듈 생성 패턴

## 파일 구조
```
apps/backend/src/modules/<name>/
├── <name>.module.ts
├── <name>.controller.ts
├── <name>.service.ts
├── <name>.gateway.ts          (WebSocket 필요 시)
└── dto/
    ├── create-<name>.dto.ts
    └── update-<name>.dto.ts
```

## Controller 패턴
- 모든 엔드포인트에 `@ApiTags`, `@ApiOperation`, `@ApiResponse`
- `@UseGuards(JwtAuthGuard)` 적용
- DTO로 입력 유효성 검증
- Response는 서비스 반환값 직접 반환 (별도 변환 레이어 없음)

## Service 패턴
- constructor에 PrismaService 주입
- 모든 public 메서드에 대한 단위 테스트
- 트랜잭션은 prisma.$transaction() 사용
- 에러는 NotFoundException, BadRequestException 등 적절한 HttpException

## DTO 패턴
- class-validator 데코레이터 사용
- @IsString(), @IsOptional(), @MaxLength() 등
- PartialType(CreateDto)로 UpdateDto 생성
```

---

## 36. Hooks 설계

> **근거**: Hooks는 결정론적(deterministic) 제어. LLM이 잊을 수 있는 규칙을 강제.

### 36.1 Hook 이벤트 활용 계획

```
PostToolUse (파일 수정 후):
  ├── Edit|Write|MultiEdit → ESLint + Prettier 자동 실행
  └── Write → .spec.ts 파일 없이 .ts 생성 시 경고

PreToolUse (도구 실행 전):
  └── Bash → 위험 명령어 차단 (rm -rf /, DROP TABLE 등)

Stop (세션 종료 시):
  └── uncommitted changes 확인 → 커밋 권유

SessionStart (세션 시작 시):
  └── Git status + Docker 상태 + 최근 TODO 출력
```

### 36.2 Hook 스크립트

#### 자동 린트/포맷 (PostToolUse)

```bash
#!/bin/bash
# scripts/hooks/lint-changed.sh
# PostToolUse에서 파일 수정 후 자동 실행

INPUT=$(cat)
FILE_PATH=$(echo "$INPUT" | jq -r '.tool_input.file_path // .tool_input.path // empty')

if [ -z "$FILE_PATH" ]; then
  exit 0
fi

# TypeScript/JavaScript 파일만 처리
if [[ "$FILE_PATH" =~ \.(ts|tsx|js|jsx)$ ]]; then
  # Prettier 포맷팅
  npx prettier --write "$FILE_PATH" 2>/dev/null
  
  # ESLint 자동 수정
  npx eslint --fix "$FILE_PATH" 2>/dev/null
fi

exit 0
```

#### 위험 명령어 차단 (PreToolUse)

```bash
#!/bin/bash
# scripts/hooks/block-dangerous.sh
# PreToolUse에서 위험 명령어 차단

INPUT=$(cat)
COMMAND=$(echo "$INPUT" | jq -r '.tool_input.command // empty')

DANGEROUS_PATTERNS=(
  "rm -rf /"
  "rm -rf /*"
  "DROP DATABASE"
  "DROP TABLE"
  "TRUNCATE"
  "docker system prune -af"
  "> /dev/sda"
  "mkfs"
  ":(){:|:&};:"
)

for pattern in "${DANGEROUS_PATTERNS[@]}"; do
  if echo "$COMMAND" | grep -qi "$pattern"; then
    echo "[BLOCKED] 위험 명령어 감지: $COMMAND" >&2
    exit 2  # exit 2 = 명령 차단
  fi
done

# 운영 DB 직접 접근 차단 (개발 DB만 허용)
if echo "$COMMAND" | grep -q "5432" && echo "$COMMAND" | grep -qi "psql\|pg_dump\|prisma"; then
  echo "[BLOCKED] 운영 DB 직접 접근 금지. 개발 DB(:5433)를 사용하세요." >&2
  exit 2
fi

exit 0
```

---

## 37. settings.json 통합 설정

```jsonc
// .claude/settings.json
{
  "model": "sonnet",
  "permissions": {
    "allow": [
      "Read",
      "Glob",
      "Grep",
      "Write",
      "Edit",
      "MultiEdit",
      "Bash(pnpm *)",
      "Bash(npm *)",
      "Bash(npx *)",
      "Bash(docker compose *)",
      "Bash(docker exec *)",
      "Bash(git *)",
      "Bash(curl *)",
      "Bash(cat *)",
      "Bash(ls *)",
      "Bash(find *)",
      "Bash(grep *)",
      "Bash(cd *)",
      "Bash(mkdir *)",
      "Bash(cp *)",
      "Bash(mv *)"
    ],
    "deny": [
      "Bash(rm -rf /)",
      "Bash(sudo *)",
      "Bash(chmod 777 *)"
    ]
  },
  "env": {
    "MAX_THINKING_TOKENS": "10000",
    "CLAUDE_AUTOCOMPACT_PCT_OVERRIDE": "60"
  },
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write|Edit|MultiEdit",
        "hooks": [
          {
            "type": "command",
            "command": "$CLAUDE_PROJECT_DIR/scripts/hooks/lint-changed.sh"
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "$CLAUDE_PROJECT_DIR/scripts/hooks/block-dangerous.sh"
          }
        ]
      }
    ]
  }
}
```

---

## 38. MCP 서버 연동

> **근거**: MCP(Model Context Protocol)로 외부 도구를 Claude Code에 연결. 솔로 개발에 유용한 서버만 선택.

```bash
# PostgreSQL 직접 쿼리 (개발 DB만)
claude mcp add postgres-dev npx @anthropic-ai/mcp-server-postgres \
  "postgresql://kanflow:kanflow_dev_2026@localhost:5433/kanflow_dev"

# 파일 시스템 (프로젝트 디렉토리만)
claude mcp add filesystem npx @anthropic-ai/mcp-server-filesystem \
  /home/dev/kanflow

# GitHub (이슈/PR 관리)
claude mcp add github npx @anthropic-ai/mcp-server-github
```

---

## 39. 솔로 개발 오케스트레이션 워크플로우

### 39.1 전체 개발 사이클

```
솔로 개발자의 일반적 개발 사이클

┌─────────────────────────────────────────────────────────────┐
│                    /new-feature "기능 설명"                   │
│                                                              │
│  ┌──────────┐    ┌──────────┐    ┌──────────┐               │
│  │   조사    │───▶│   설계    │───▶│ 개발자    │               │
│  │researcher│    │architect │    │ 승인 대기 │               │
│  │subagent  │    │subagent  │    │          │               │
│  └──────────┘    └──────────┘    └────┬─────┘               │
│                                      │ 승인                  │
│                                      ▼                      │
│  ┌──────────┐    ┌──────────┐    ┌──────────┐               │
│  │   최종    │◀───│  리뷰    │◀───│   구현    │               │
│  │ 테스트    │    │reviewer  │    │implement │               │
│  │확인+커밋  │    │subagent  │    │subagent  │               │
│  └──────────┘    └──────────┘    └──────────┘               │
│                                                              │
│  Hook이 자동으로:                                             │
│  - 파일 수정 시 → ESLint + Prettier 실행                     │
│  - 위험 명령어 → 차단                                        │
│  - 세션 종료 → uncommitted changes 알림                      │
└─────────────────────────────────────────────────────────────┘
```

### 39.2 일상 개발 패턴

```
아침 시작:
  1. claude 시작 → SessionStart hook이 자동으로 상태 보고
  2. /status → 프로젝트 상태 종합 확인
  3. /new-feature "스윔레인 CRUD" → 파이프라인 시작

기능 구현:
  4. Researcher가 기존 코드 분석 → 결과 요약 반환
  5. Architect가 설계 → ADR 작성 → 개발자 승인 대기
  6. 승인 후 Implementer가 코드 구현 (Hook이 자동 포맷)
  7. Reviewer가 코드 리뷰 → Critical 수정 → 재리뷰

마무리:
  8. /test → 전체 테스트
  9. git commit → /deploy (필요 시)

버그 수정:
  - /fix "카드 드래그 시 position 오류" → 조사+수정+테스트 한 번에
```

### 39.3 Subagent vs 직접 작업 판단 기준

```
Subagent에 위임:
  ✅ 많은 파일을 읽어야 하는 조사 작업 (컨텍스트 절약)
  ✅ 코드 리뷰 (독립적 관점 확보)
  ✅ 설계 문서 작성 (구조화된 출력)
  ✅ 테스트 실행 및 결과 분석

직접 작업:
  ✅ 간단한 버그 수정 (1-2 파일)
  ✅ 소규모 리팩토링
  ✅ 설정 파일 수정
  ✅ 기존 패턴대로의 반복 구현
```

---

## 40. 토큰 최적화 전략

> **근거**: Claude Code 사용 비용 관리는 솔로 개발에서 매우 중요

### 40.1 비용 절감 설정

```jsonc
// settings.json에 적용
{
  "model": "sonnet",                              // 기본 Sonnet (비용 효율)
  "env": {
    "MAX_THINKING_TOKENS": "10000",               // 사고 토큰 제한
    "CLAUDE_AUTOCOMPACT_PCT_OVERRIDE": "60",       // 60%에서 자동 압축
    "CLAUDE_CODE_SUBAGENT_MODEL": "sonnet"         // 서브에이전트도 Sonnet
  }
}
```

### 40.2 컨텍스트 관리 규칙

```
1. /clear: 관련 없는 작업 전환 시 항상 실행
2. /compact: 논리적 구간 완료 시 수동 압축
3. /cost: 주기적으로 토큰 사용량 확인
4. 대규모 조사는 반드시 Subagent 위임 (메인 컨텍스트 보호)
5. CLAUDE.md에 안정적 컨텍스트 유지 (반복 설명 방지)
6. 긴 파일 읽기: 필요한 부분만 Grep/Glob으로 지정
```

### 40.3 효율적 프롬프팅 패턴

```
❌ 비효율: "보드 모듈을 만들어줘"
  → Claude가 추측으로 전체 구현 시도 → 수정 반복 → 토큰 낭비

✅ 효율: "/new-feature 보드 CRUD API"
  → Researcher가 기존 패턴 조사
  → Architect가 구조 설계 → 개발자 확인
  → Implementer가 확인된 설계대로 구현
  → 1회에 정확한 구현 → 토큰 절약
```

---

## 전체 디렉토리 구조 (Claude Code 설정 포함)

```
kanflow/
├── .claude/
│   ├── CLAUDE.md                    # 프로젝트 컨텍스트
│   ├── settings.json                # 권한, 모델, hooks
│   ├── settings.local.json          # 개인 오버라이드 (git 제외)
│   │
│   ├── agents/                      # Subagents
│   │   ├── researcher.md
│   │   ├── architect.md
│   │   ├── implementer.md
│   │   └── reviewer.md
│   │
│   ├── commands/                    # Slash Commands
│   │   ├── setup.md
│   │   ├── dev.md
│   │   ├── new-feature.md
│   │   ├── implement.md
│   │   ├── review.md
│   │   ├── test.md
│   │   ├── db-migrate.md
│   │   ├── deploy.md
│   │   ├── status.md
│   │   └── fix.md
│   │
│   └── skills/                      # Skills (자동 트리거)
│       ├── nestjs-module/SKILL.md
│       ├── react-component/SKILL.md
│       ├── prisma-migration/SKILL.md
│       ├── api-endpoint/SKILL.md
│       └── dnd-feature/SKILL.md
│
├── scripts/
│   ├── hooks/                       # Hook 스크립트
│   │   ├── lint-changed.sh
│   │   └── block-dangerous.sh
│   ├── setup.sh
│   ├── dev.sh
│   ├── deploy.sh
│   └── backup.sh
│
├── docs/
│   ├── adr/                         # Architecture Decision Records
│   ├── FRD-v2.0-20260224.md         # 이 문서
│   └── architecture.md
│
├── apps/
│   ├── frontend/
│   └── backend/
│
├── packages/
│   └── shared/
│
├── docker/
│   ├── dev/
│   └── prod/
│
├── pnpm-workspace.yaml
├── turbo.json
├── package.json
└── .gitignore
```

---

> **문서 끝**  
> 버전: v2.0 | 작성일: 2026-02-24  
> Part 1: 칸반 보드 기능 30개 카테고리, ~145개 기능 항목  
> Part 2: Claude Code 솔로 개발 환경 (Subagent 4개, Command 10개, Skill 5개, Hook 2개)
